parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({"oY0f":[function(require,module,exports) {
var define;
var t;!function(n){"use strict";var r={};"undefined"==typeof exports?"function"==typeof t&&"object"==typeof t.amd&&t.amd?(r.exports={},t(function(){return r.exports})):r.exports="undefined"!=typeof window?window:n:r.exports=exports,function(t){if(!n)var n=1e-6;if(!r)var r="undefined"!=typeof Float32Array?Float32Array:Array;if(!a)var a=Math.random;var e={setMatrixArrayType:function(t){r=t}};void 0!==t&&(t.glMatrix=e);var u=Math.PI/180;e.toRadian=function(t){return t*u};var o,i={};i.create=function(){var t=new r(2);return t[0]=0,t[1]=0,t},i.clone=function(t){var n=new r(2);return n[0]=t[0],n[1]=t[1],n},i.fromValues=function(t,n){var a=new r(2);return a[0]=t,a[1]=n,a},i.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t},i.set=function(t,n,r){return t[0]=n,t[1]=r,t},i.add=function(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t},i.subtract=function(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t},i.sub=i.subtract,i.multiply=function(t,n,r){return t[0]=n[0]*r[0],t[1]=n[1]*r[1],t},i.mul=i.multiply,i.divide=function(t,n,r){return t[0]=n[0]/r[0],t[1]=n[1]/r[1],t},i.div=i.divide,i.min=function(t,n,r){return t[0]=Math.min(n[0],r[0]),t[1]=Math.min(n[1],r[1]),t},i.max=function(t,n,r){return t[0]=Math.max(n[0],r[0]),t[1]=Math.max(n[1],r[1]),t},i.scale=function(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t},i.scaleAndAdd=function(t,n,r,a){return t[0]=n[0]+r[0]*a,t[1]=n[1]+r[1]*a,t},i.distance=function(t,n){var r=n[0]-t[0],a=n[1]-t[1];return Math.sqrt(r*r+a*a)},i.dist=i.distance,i.squaredDistance=function(t,n){var r=n[0]-t[0],a=n[1]-t[1];return r*r+a*a},i.sqrDist=i.squaredDistance,i.length=function(t){var n=t[0],r=t[1];return Math.sqrt(n*n+r*r)},i.len=i.length,i.squaredLength=function(t){var n=t[0],r=t[1];return n*n+r*r},i.sqrLen=i.squaredLength,i.negate=function(t,n){return t[0]=-n[0],t[1]=-n[1],t},i.normalize=function(t,n){var r=n[0],a=n[1],e=r*r+a*a;return e>0&&(e=1/Math.sqrt(e),t[0]=n[0]*e,t[1]=n[1]*e),t},i.dot=function(t,n){return t[0]*n[0]+t[1]*n[1]},i.cross=function(t,n,r){var a=n[0]*r[1]-n[1]*r[0];return t[0]=t[1]=0,t[2]=a,t},i.lerp=function(t,n,r,a){var e=n[0],u=n[1];return t[0]=e+a*(r[0]-e),t[1]=u+a*(r[1]-u),t},i.random=function(t,n){n=n||1;var r=2*a()*Math.PI;return t[0]=Math.cos(r)*n,t[1]=Math.sin(r)*n,t},i.transformMat2=function(t,n,r){var a=n[0],e=n[1];return t[0]=r[0]*a+r[2]*e,t[1]=r[1]*a+r[3]*e,t},i.transformMat2d=function(t,n,r){var a=n[0],e=n[1];return t[0]=r[0]*a+r[2]*e+r[4],t[1]=r[1]*a+r[3]*e+r[5],t},i.transformMat3=function(t,n,r){var a=n[0],e=n[1];return t[0]=r[0]*a+r[3]*e+r[6],t[1]=r[1]*a+r[4]*e+r[7],t},i.transformMat4=function(t,n,r){var a=n[0],e=n[1];return t[0]=r[0]*a+r[4]*e+r[12],t[1]=r[1]*a+r[5]*e+r[13],t},i.forEach=(o=i.create(),function(t,n,r,a,e,u){var i,c;for(n||(n=2),r||(r=0),c=a?Math.min(a*n+r,t.length):t.length,i=r;i<c;i+=n)o[0]=t[i],o[1]=t[i+1],e(o,o,u),t[i]=o[0],t[i+1]=o[1];return t}),i.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},void 0!==t&&(t.vec2=i);var c={create:function(){var t=new r(3);return t[0]=0,t[1]=0,t[2]=0,t},clone:function(t){var n=new r(3);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n},fromValues:function(t,n,a){var e=new r(3);return e[0]=t,e[1]=n,e[2]=a,e},copy:function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t},set:function(t,n,r,a){return t[0]=n,t[1]=r,t[2]=a,t},add:function(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t},subtract:function(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t}};c.sub=c.subtract,c.multiply=function(t,n,r){return t[0]=n[0]*r[0],t[1]=n[1]*r[1],t[2]=n[2]*r[2],t},c.mul=c.multiply,c.divide=function(t,n,r){return t[0]=n[0]/r[0],t[1]=n[1]/r[1],t[2]=n[2]/r[2],t},c.div=c.divide,c.min=function(t,n,r){return t[0]=Math.min(n[0],r[0]),t[1]=Math.min(n[1],r[1]),t[2]=Math.min(n[2],r[2]),t},c.max=function(t,n,r){return t[0]=Math.max(n[0],r[0]),t[1]=Math.max(n[1],r[1]),t[2]=Math.max(n[2],r[2]),t},c.scale=function(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t},c.scaleAndAdd=function(t,n,r,a){return t[0]=n[0]+r[0]*a,t[1]=n[1]+r[1]*a,t[2]=n[2]+r[2]*a,t},c.distance=function(t,n){var r=n[0]-t[0],a=n[1]-t[1],e=n[2]-t[2];return Math.sqrt(r*r+a*a+e*e)},c.dist=c.distance,c.squaredDistance=function(t,n){var r=n[0]-t[0],a=n[1]-t[1],e=n[2]-t[2];return r*r+a*a+e*e},c.sqrDist=c.squaredDistance,c.length=function(t){var n=t[0],r=t[1],a=t[2];return Math.sqrt(n*n+r*r+a*a)},c.len=c.length,c.squaredLength=function(t){var n=t[0],r=t[1],a=t[2];return n*n+r*r+a*a},c.sqrLen=c.squaredLength,c.negate=function(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t},c.normalize=function(t,n){var r=n[0],a=n[1],e=n[2],u=r*r+a*a+e*e;return u>0&&(u=1/Math.sqrt(u),t[0]=n[0]*u,t[1]=n[1]*u,t[2]=n[2]*u),t},c.dot=function(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]},c.cross=function(t,n,r){var a=n[0],e=n[1],u=n[2],o=r[0],i=r[1],c=r[2];return t[0]=e*c-u*i,t[1]=u*o-a*c,t[2]=a*i-e*o,t},c.lerp=function(t,n,r,a){var e=n[0],u=n[1],o=n[2];return t[0]=e+a*(r[0]-e),t[1]=u+a*(r[1]-u),t[2]=o+a*(r[2]-o),t},c.random=function(t,n){n=n||1;var r=2*a()*Math.PI,e=2*a()-1,u=Math.sqrt(1-e*e)*n;return t[0]=Math.cos(r)*u,t[1]=Math.sin(r)*u,t[2]=e*n,t},c.transformMat4=function(t,n,r){var a=n[0],e=n[1],u=n[2];return t[0]=r[0]*a+r[4]*e+r[8]*u+r[12],t[1]=r[1]*a+r[5]*e+r[9]*u+r[13],t[2]=r[2]*a+r[6]*e+r[10]*u+r[14],t},c.transformMat3=function(t,n,r){var a=n[0],e=n[1],u=n[2];return t[0]=a*r[0]+e*r[3]+u*r[6],t[1]=a*r[1]+e*r[4]+u*r[7],t[2]=a*r[2]+e*r[5]+u*r[8],t},c.transformQuat=function(t,n,r){var a=n[0],e=n[1],u=n[2],o=r[0],i=r[1],c=r[2],f=r[3],s=f*a+i*u-c*e,h=f*e+c*a-o*u,v=f*u+o*e-i*a,M=-o*a-i*e-c*u;return t[0]=s*f+M*-o+h*-c-v*-i,t[1]=h*f+M*-i+v*-o-s*-c,t[2]=v*f+M*-c+s*-i-h*-o,t},c.rotateX=function(t,n,r,a){var e=[],u=[];return e[0]=n[0]-r[0],e[1]=n[1]-r[1],e[2]=n[2]-r[2],u[0]=e[0],u[1]=e[1]*Math.cos(a)-e[2]*Math.sin(a),u[2]=e[1]*Math.sin(a)+e[2]*Math.cos(a),t[0]=u[0]+r[0],t[1]=u[1]+r[1],t[2]=u[2]+r[2],t},c.rotateY=function(t,n,r,a){var e=[],u=[];return e[0]=n[0]-r[0],e[1]=n[1]-r[1],e[2]=n[2]-r[2],u[0]=e[2]*Math.sin(a)+e[0]*Math.cos(a),u[1]=e[1],u[2]=e[2]*Math.cos(a)-e[0]*Math.sin(a),t[0]=u[0]+r[0],t[1]=u[1]+r[1],t[2]=u[2]+r[2],t},c.rotateZ=function(t,n,r,a){var e=[],u=[];return e[0]=n[0]-r[0],e[1]=n[1]-r[1],e[2]=n[2]-r[2],u[0]=e[0]*Math.cos(a)-e[1]*Math.sin(a),u[1]=e[0]*Math.sin(a)+e[1]*Math.cos(a),u[2]=e[2],t[0]=u[0]+r[0],t[1]=u[1]+r[1],t[2]=u[2]+r[2],t},c.forEach=function(){var t=c.create();return function(n,r,a,e,u,o){var i,c;for(r||(r=3),a||(a=0),c=e?Math.min(e*r+a,n.length):n.length,i=a;i<c;i+=r)t[0]=n[i],t[1]=n[i+1],t[2]=n[i+2],u(t,t,o),n[i]=t[0],n[i+1]=t[1],n[i+2]=t[2];return n}}(),c.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},void 0!==t&&(t.vec3=c);var f={create:function(){var t=new r(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},clone:function(t){var n=new r(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n},fromValues:function(t,n,a,e){var u=new r(4);return u[0]=t,u[1]=n,u[2]=a,u[3]=e,u},copy:function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t},set:function(t,n,r,a,e){return t[0]=n,t[1]=r,t[2]=a,t[3]=e,t},add:function(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t},subtract:function(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t[3]=n[3]-r[3],t}};f.sub=f.subtract,f.multiply=function(t,n,r){return t[0]=n[0]*r[0],t[1]=n[1]*r[1],t[2]=n[2]*r[2],t[3]=n[3]*r[3],t},f.mul=f.multiply,f.divide=function(t,n,r){return t[0]=n[0]/r[0],t[1]=n[1]/r[1],t[2]=n[2]/r[2],t[3]=n[3]/r[3],t},f.div=f.divide,f.min=function(t,n,r){return t[0]=Math.min(n[0],r[0]),t[1]=Math.min(n[1],r[1]),t[2]=Math.min(n[2],r[2]),t[3]=Math.min(n[3],r[3]),t},f.max=function(t,n,r){return t[0]=Math.max(n[0],r[0]),t[1]=Math.max(n[1],r[1]),t[2]=Math.max(n[2],r[2]),t[3]=Math.max(n[3],r[3]),t},f.scale=function(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t},f.scaleAndAdd=function(t,n,r,a){return t[0]=n[0]+r[0]*a,t[1]=n[1]+r[1]*a,t[2]=n[2]+r[2]*a,t[3]=n[3]+r[3]*a,t},f.distance=function(t,n){var r=n[0]-t[0],a=n[1]-t[1],e=n[2]-t[2],u=n[3]-t[3];return Math.sqrt(r*r+a*a+e*e+u*u)},f.dist=f.distance,f.squaredDistance=function(t,n){var r=n[0]-t[0],a=n[1]-t[1],e=n[2]-t[2],u=n[3]-t[3];return r*r+a*a+e*e+u*u},f.sqrDist=f.squaredDistance,f.length=function(t){var n=t[0],r=t[1],a=t[2],e=t[3];return Math.sqrt(n*n+r*r+a*a+e*e)},f.len=f.length,f.squaredLength=function(t){var n=t[0],r=t[1],a=t[2],e=t[3];return n*n+r*r+a*a+e*e},f.sqrLen=f.squaredLength,f.negate=function(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=-n[3],t},f.normalize=function(t,n){var r=n[0],a=n[1],e=n[2],u=n[3],o=r*r+a*a+e*e+u*u;return o>0&&(o=1/Math.sqrt(o),t[0]=n[0]*o,t[1]=n[1]*o,t[2]=n[2]*o,t[3]=n[3]*o),t},f.dot=function(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]+t[3]*n[3]},f.lerp=function(t,n,r,a){var e=n[0],u=n[1],o=n[2],i=n[3];return t[0]=e+a*(r[0]-e),t[1]=u+a*(r[1]-u),t[2]=o+a*(r[2]-o),t[3]=i+a*(r[3]-i),t},f.random=function(t,n){return n=n||1,t[0]=a(),t[1]=a(),t[2]=a(),t[3]=a(),f.normalize(t,t),f.scale(t,t,n),t},f.transformMat4=function(t,n,r){var a=n[0],e=n[1],u=n[2],o=n[3];return t[0]=r[0]*a+r[4]*e+r[8]*u+r[12]*o,t[1]=r[1]*a+r[5]*e+r[9]*u+r[13]*o,t[2]=r[2]*a+r[6]*e+r[10]*u+r[14]*o,t[3]=r[3]*a+r[7]*e+r[11]*u+r[15]*o,t},f.transformQuat=function(t,n,r){var a=n[0],e=n[1],u=n[2],o=r[0],i=r[1],c=r[2],f=r[3],s=f*a+i*u-c*e,h=f*e+c*a-o*u,v=f*u+o*e-i*a,M=-o*a-i*e-c*u;return t[0]=s*f+M*-o+h*-c-v*-i,t[1]=h*f+M*-i+v*-o-s*-c,t[2]=v*f+M*-c+s*-i-h*-o,t},f.forEach=function(){var t=f.create();return function(n,r,a,e,u,o){var i,c;for(r||(r=4),a||(a=0),c=e?Math.min(e*r+a,n.length):n.length,i=a;i<c;i+=r)t[0]=n[i],t[1]=n[i+1],t[2]=n[i+2],t[3]=n[i+3],u(t,t,o),n[i]=t[0],n[i+1]=t[1],n[i+2]=t[2],n[i+3]=t[3];return n}}(),f.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},void 0!==t&&(t.vec4=f);var s={create:function(){var t=new r(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},clone:function(t){var n=new r(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n},copy:function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},transpose:function(t,n){if(t===n){var r=n[1];t[1]=n[2],t[2]=r}else t[0]=n[0],t[1]=n[2],t[2]=n[1],t[3]=n[3];return t},invert:function(t,n){var r=n[0],a=n[1],e=n[2],u=n[3],o=r*u-e*a;return o?(o=1/o,t[0]=u*o,t[1]=-a*o,t[2]=-e*o,t[3]=r*o,t):null},adjoint:function(t,n){var r=n[0];return t[0]=n[3],t[1]=-n[1],t[2]=-n[2],t[3]=r,t},determinant:function(t){return t[0]*t[3]-t[2]*t[1]},multiply:function(t,n,r){var a=n[0],e=n[1],u=n[2],o=n[3],i=r[0],c=r[1],f=r[2],s=r[3];return t[0]=a*i+u*c,t[1]=e*i+o*c,t[2]=a*f+u*s,t[3]=e*f+o*s,t}};s.mul=s.multiply,s.rotate=function(t,n,r){var a=n[0],e=n[1],u=n[2],o=n[3],i=Math.sin(r),c=Math.cos(r);return t[0]=a*c+u*i,t[1]=e*c+o*i,t[2]=a*-i+u*c,t[3]=e*-i+o*c,t},s.scale=function(t,n,r){var a=n[0],e=n[1],u=n[2],o=n[3],i=r[0],c=r[1];return t[0]=a*i,t[1]=e*i,t[2]=u*c,t[3]=o*c,t},s.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},s.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},s.LDU=function(t,n,r,a){return t[2]=a[2]/a[0],r[0]=a[0],r[1]=a[1],r[3]=a[3]-t[2]*r[1],[t,n,r]},void 0!==t&&(t.mat2=s);var h={create:function(){var t=new r(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},clone:function(t){var n=new r(6);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n},copy:function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},invert:function(t,n){var r=n[0],a=n[1],e=n[2],u=n[3],o=n[4],i=n[5],c=r*u-a*e;return c?(c=1/c,t[0]=u*c,t[1]=-a*c,t[2]=-e*c,t[3]=r*c,t[4]=(e*i-u*o)*c,t[5]=(a*o-r*i)*c,t):null},determinant:function(t){return t[0]*t[3]-t[1]*t[2]},multiply:function(t,n,r){var a=n[0],e=n[1],u=n[2],o=n[3],i=n[4],c=n[5],f=r[0],s=r[1],h=r[2],v=r[3],M=r[4],l=r[5];return t[0]=a*f+u*s,t[1]=e*f+o*s,t[2]=a*h+u*v,t[3]=e*h+o*v,t[4]=a*M+u*l+i,t[5]=e*M+o*l+c,t}};h.mul=h.multiply,h.rotate=function(t,n,r){var a=n[0],e=n[1],u=n[2],o=n[3],i=n[4],c=n[5],f=Math.sin(r),s=Math.cos(r);return t[0]=a*s+u*f,t[1]=e*s+o*f,t[2]=a*-f+u*s,t[3]=e*-f+o*s,t[4]=i,t[5]=c,t},h.scale=function(t,n,r){var a=n[0],e=n[1],u=n[2],o=n[3],i=n[4],c=n[5],f=r[0],s=r[1];return t[0]=a*f,t[1]=e*f,t[2]=u*s,t[3]=o*s,t[4]=i,t[5]=c,t},h.translate=function(t,n,r){var a=n[0],e=n[1],u=n[2],o=n[3],i=n[4],c=n[5],f=r[0],s=r[1];return t[0]=a,t[1]=e,t[2]=u,t[3]=o,t[4]=a*f+u*s+i,t[5]=e*f+o*s+c,t},h.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},h.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},void 0!==t&&(t.mat2d=h);var v={create:function(){var t=new r(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},fromMat4:function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[4],t[4]=n[5],t[5]=n[6],t[6]=n[8],t[7]=n[9],t[8]=n[10],t},clone:function(t){var n=new r(9);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n},copy:function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},transpose:function(t,n){if(t===n){var r=n[1],a=n[2],e=n[5];t[1]=n[3],t[2]=n[6],t[3]=r,t[5]=n[7],t[6]=a,t[7]=e}else t[0]=n[0],t[1]=n[3],t[2]=n[6],t[3]=n[1],t[4]=n[4],t[5]=n[7],t[6]=n[2],t[7]=n[5],t[8]=n[8];return t},invert:function(t,n){var r=n[0],a=n[1],e=n[2],u=n[3],o=n[4],i=n[5],c=n[6],f=n[7],s=n[8],h=s*o-i*f,v=-s*u+i*c,M=f*u-o*c,l=r*h+a*v+e*M;return l?(l=1/l,t[0]=h*l,t[1]=(-s*a+e*f)*l,t[2]=(i*a-e*o)*l,t[3]=v*l,t[4]=(s*r-e*c)*l,t[5]=(-i*r+e*u)*l,t[6]=M*l,t[7]=(-f*r+a*c)*l,t[8]=(o*r-a*u)*l,t):null},adjoint:function(t,n){var r=n[0],a=n[1],e=n[2],u=n[3],o=n[4],i=n[5],c=n[6],f=n[7],s=n[8];return t[0]=o*s-i*f,t[1]=e*f-a*s,t[2]=a*i-e*o,t[3]=i*c-u*s,t[4]=r*s-e*c,t[5]=e*u-r*i,t[6]=u*f-o*c,t[7]=a*c-r*f,t[8]=r*o-a*u,t},determinant:function(t){var n=t[0],r=t[1],a=t[2],e=t[3],u=t[4],o=t[5],i=t[6],c=t[7],f=t[8];return n*(f*u-o*c)+r*(-f*e+o*i)+a*(c*e-u*i)},multiply:function(t,n,r){var a=n[0],e=n[1],u=n[2],o=n[3],i=n[4],c=n[5],f=n[6],s=n[7],h=n[8],v=r[0],M=r[1],l=r[2],d=r[3],m=r[4],p=r[5],w=r[6],q=r[7],y=r[8];return t[0]=v*a+M*o+l*f,t[1]=v*e+M*i+l*s,t[2]=v*u+M*c+l*h,t[3]=d*a+m*o+p*f,t[4]=d*e+m*i+p*s,t[5]=d*u+m*c+p*h,t[6]=w*a+q*o+y*f,t[7]=w*e+q*i+y*s,t[8]=w*u+q*c+y*h,t}};v.mul=v.multiply,v.translate=function(t,n,r){var a=n[0],e=n[1],u=n[2],o=n[3],i=n[4],c=n[5],f=n[6],s=n[7],h=n[8],v=r[0],M=r[1];return t[0]=a,t[1]=e,t[2]=u,t[3]=o,t[4]=i,t[5]=c,t[6]=v*a+M*o+f,t[7]=v*e+M*i+s,t[8]=v*u+M*c+h,t},v.rotate=function(t,n,r){var a=n[0],e=n[1],u=n[2],o=n[3],i=n[4],c=n[5],f=n[6],s=n[7],h=n[8],v=Math.sin(r),M=Math.cos(r);return t[0]=M*a+v*o,t[1]=M*e+v*i,t[2]=M*u+v*c,t[3]=M*o-v*a,t[4]=M*i-v*e,t[5]=M*c-v*u,t[6]=f,t[7]=s,t[8]=h,t},v.scale=function(t,n,r){var a=r[0],e=r[1];return t[0]=a*n[0],t[1]=a*n[1],t[2]=a*n[2],t[3]=e*n[3],t[4]=e*n[4],t[5]=e*n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t},v.fromMat2d=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=0,t[3]=n[2],t[4]=n[3],t[5]=0,t[6]=n[4],t[7]=n[5],t[8]=1,t},v.fromQuat=function(t,n){var r=n[0],a=n[1],e=n[2],u=n[3],o=r+r,i=a+a,c=e+e,f=r*o,s=a*o,h=a*i,v=e*o,M=e*i,l=e*c,d=u*o,m=u*i,p=u*c;return t[0]=1-h-l,t[3]=s-p,t[6]=v+m,t[1]=s+p,t[4]=1-f-l,t[7]=M-d,t[2]=v-m,t[5]=M+d,t[8]=1-f-h,t},v.normalFromMat4=function(t,n){var r=n[0],a=n[1],e=n[2],u=n[3],o=n[4],i=n[5],c=n[6],f=n[7],s=n[8],h=n[9],v=n[10],M=n[11],l=n[12],d=n[13],m=n[14],p=n[15],w=r*i-a*o,q=r*c-e*o,y=r*f-u*o,g=a*c-e*i,x=a*f-u*i,b=e*f-u*c,A=s*d-h*l,L=s*m-v*l,D=s*p-M*l,z=h*m-v*d,V=h*p-M*d,j=v*p-M*m,I=w*j-q*V+y*z+g*D-x*L+b*A;return I?(I=1/I,t[0]=(i*j-c*V+f*z)*I,t[1]=(c*D-o*j-f*L)*I,t[2]=(o*V-i*D+f*A)*I,t[3]=(e*V-a*j-u*z)*I,t[4]=(r*j-e*D+u*L)*I,t[5]=(a*D-r*V-u*A)*I,t[6]=(d*b-m*x+p*g)*I,t[7]=(m*y-l*b-p*q)*I,t[8]=(l*x-d*y+p*w)*I,t):null},v.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},v.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},void 0!==t&&(t.mat3=v);var M={create:function(){var t=new r(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},clone:function(t){var n=new r(16);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n},copy:function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},transpose:function(t,n){if(t===n){var r=n[1],a=n[2],e=n[3],u=n[6],o=n[7],i=n[11];t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=r,t[6]=n[9],t[7]=n[13],t[8]=a,t[9]=u,t[11]=n[14],t[12]=e,t[13]=o,t[14]=i}else t[0]=n[0],t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=n[1],t[5]=n[5],t[6]=n[9],t[7]=n[13],t[8]=n[2],t[9]=n[6],t[10]=n[10],t[11]=n[14],t[12]=n[3],t[13]=n[7],t[14]=n[11],t[15]=n[15];return t},invert:function(t,n){var r=n[0],a=n[1],e=n[2],u=n[3],o=n[4],i=n[5],c=n[6],f=n[7],s=n[8],h=n[9],v=n[10],M=n[11],l=n[12],d=n[13],m=n[14],p=n[15],w=r*i-a*o,q=r*c-e*o,y=r*f-u*o,g=a*c-e*i,x=a*f-u*i,b=e*f-u*c,A=s*d-h*l,L=s*m-v*l,D=s*p-M*l,z=h*m-v*d,V=h*p-M*d,j=v*p-M*m,I=w*j-q*V+y*z+g*D-x*L+b*A;return I?(I=1/I,t[0]=(i*j-c*V+f*z)*I,t[1]=(e*V-a*j-u*z)*I,t[2]=(d*b-m*x+p*g)*I,t[3]=(v*x-h*b-M*g)*I,t[4]=(c*D-o*j-f*L)*I,t[5]=(r*j-e*D+u*L)*I,t[6]=(m*y-l*b-p*q)*I,t[7]=(s*b-v*y+M*q)*I,t[8]=(o*V-i*D+f*A)*I,t[9]=(a*D-r*V-u*A)*I,t[10]=(l*x-d*y+p*w)*I,t[11]=(h*y-s*x-M*w)*I,t[12]=(i*L-o*z-c*A)*I,t[13]=(r*z-a*L+e*A)*I,t[14]=(d*q-l*g-m*w)*I,t[15]=(s*g-h*q+v*w)*I,t):null},adjoint:function(t,n){var r=n[0],a=n[1],e=n[2],u=n[3],o=n[4],i=n[5],c=n[6],f=n[7],s=n[8],h=n[9],v=n[10],M=n[11],l=n[12],d=n[13],m=n[14],p=n[15];return t[0]=i*(v*p-M*m)-h*(c*p-f*m)+d*(c*M-f*v),t[1]=-(a*(v*p-M*m)-h*(e*p-u*m)+d*(e*M-u*v)),t[2]=a*(c*p-f*m)-i*(e*p-u*m)+d*(e*f-u*c),t[3]=-(a*(c*M-f*v)-i*(e*M-u*v)+h*(e*f-u*c)),t[4]=-(o*(v*p-M*m)-s*(c*p-f*m)+l*(c*M-f*v)),t[5]=r*(v*p-M*m)-s*(e*p-u*m)+l*(e*M-u*v),t[6]=-(r*(c*p-f*m)-o*(e*p-u*m)+l*(e*f-u*c)),t[7]=r*(c*M-f*v)-o*(e*M-u*v)+s*(e*f-u*c),t[8]=o*(h*p-M*d)-s*(i*p-f*d)+l*(i*M-f*h),t[9]=-(r*(h*p-M*d)-s*(a*p-u*d)+l*(a*M-u*h)),t[10]=r*(i*p-f*d)-o*(a*p-u*d)+l*(a*f-u*i),t[11]=-(r*(i*M-f*h)-o*(a*M-u*h)+s*(a*f-u*i)),t[12]=-(o*(h*m-v*d)-s*(i*m-c*d)+l*(i*v-c*h)),t[13]=r*(h*m-v*d)-s*(a*m-e*d)+l*(a*v-e*h),t[14]=-(r*(i*m-c*d)-o*(a*m-e*d)+l*(a*c-e*i)),t[15]=r*(i*v-c*h)-o*(a*v-e*h)+s*(a*c-e*i),t},determinant:function(t){var n=t[0],r=t[1],a=t[2],e=t[3],u=t[4],o=t[5],i=t[6],c=t[7],f=t[8],s=t[9],h=t[10],v=t[11],M=t[12],l=t[13],d=t[14],m=t[15];return(n*o-r*u)*(h*m-v*d)-(n*i-a*u)*(s*m-v*l)+(n*c-e*u)*(s*d-h*l)+(r*i-a*o)*(f*m-v*M)-(r*c-e*o)*(f*d-h*M)+(a*c-e*i)*(f*l-s*M)},multiply:function(t,n,r){var a=n[0],e=n[1],u=n[2],o=n[3],i=n[4],c=n[5],f=n[6],s=n[7],h=n[8],v=n[9],M=n[10],l=n[11],d=n[12],m=n[13],p=n[14],w=n[15],q=r[0],y=r[1],g=r[2],x=r[3];return t[0]=q*a+y*i+g*h+x*d,t[1]=q*e+y*c+g*v+x*m,t[2]=q*u+y*f+g*M+x*p,t[3]=q*o+y*s+g*l+x*w,q=r[4],y=r[5],g=r[6],x=r[7],t[4]=q*a+y*i+g*h+x*d,t[5]=q*e+y*c+g*v+x*m,t[6]=q*u+y*f+g*M+x*p,t[7]=q*o+y*s+g*l+x*w,q=r[8],y=r[9],g=r[10],x=r[11],t[8]=q*a+y*i+g*h+x*d,t[9]=q*e+y*c+g*v+x*m,t[10]=q*u+y*f+g*M+x*p,t[11]=q*o+y*s+g*l+x*w,q=r[12],y=r[13],g=r[14],x=r[15],t[12]=q*a+y*i+g*h+x*d,t[13]=q*e+y*c+g*v+x*m,t[14]=q*u+y*f+g*M+x*p,t[15]=q*o+y*s+g*l+x*w,t}};M.mul=M.multiply,M.translate=function(t,n,r){var a,e,u,o,i,c,f,s,h,v,M,l,d=r[0],m=r[1],p=r[2];return n===t?(t[12]=n[0]*d+n[4]*m+n[8]*p+n[12],t[13]=n[1]*d+n[5]*m+n[9]*p+n[13],t[14]=n[2]*d+n[6]*m+n[10]*p+n[14],t[15]=n[3]*d+n[7]*m+n[11]*p+n[15]):(a=n[0],e=n[1],u=n[2],o=n[3],i=n[4],c=n[5],f=n[6],s=n[7],h=n[8],v=n[9],M=n[10],l=n[11],t[0]=a,t[1]=e,t[2]=u,t[3]=o,t[4]=i,t[5]=c,t[6]=f,t[7]=s,t[8]=h,t[9]=v,t[10]=M,t[11]=l,t[12]=a*d+i*m+h*p+n[12],t[13]=e*d+c*m+v*p+n[13],t[14]=u*d+f*m+M*p+n[14],t[15]=o*d+s*m+l*p+n[15]),t},M.scale=function(t,n,r){var a=r[0],e=r[1],u=r[2];return t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t[3]=n[3]*a,t[4]=n[4]*e,t[5]=n[5]*e,t[6]=n[6]*e,t[7]=n[7]*e,t[8]=n[8]*u,t[9]=n[9]*u,t[10]=n[10]*u,t[11]=n[11]*u,t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},M.rotate=function(t,r,a,e){var u,o,i,c,f,s,h,v,M,l,d,m,p,w,q,y,g,x,b,A,L,D,z,V,j=e[0],I=e[1],P=e[2],Q=Math.sqrt(j*j+I*I+P*P);return Math.abs(Q)<n?null:(j*=Q=1/Q,I*=Q,P*=Q,u=Math.sin(a),i=1-(o=Math.cos(a)),c=r[0],f=r[1],s=r[2],h=r[3],v=r[4],M=r[5],l=r[6],d=r[7],m=r[8],p=r[9],w=r[10],q=r[11],y=j*j*i+o,g=I*j*i+P*u,x=P*j*i-I*u,b=j*I*i-P*u,A=I*I*i+o,L=P*I*i+j*u,D=j*P*i+I*u,z=I*P*i-j*u,V=P*P*i+o,t[0]=c*y+v*g+m*x,t[1]=f*y+M*g+p*x,t[2]=s*y+l*g+w*x,t[3]=h*y+d*g+q*x,t[4]=c*b+v*A+m*L,t[5]=f*b+M*A+p*L,t[6]=s*b+l*A+w*L,t[7]=h*b+d*A+q*L,t[8]=c*D+v*z+m*V,t[9]=f*D+M*z+p*V,t[10]=s*D+l*z+w*V,t[11]=h*D+d*z+q*V,r!==t&&(t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t)},M.rotateX=function(t,n,r){var a=Math.sin(r),e=Math.cos(r),u=n[4],o=n[5],i=n[6],c=n[7],f=n[8],s=n[9],h=n[10],v=n[11];return n!==t&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[4]=u*e+f*a,t[5]=o*e+s*a,t[6]=i*e+h*a,t[7]=c*e+v*a,t[8]=f*e-u*a,t[9]=s*e-o*a,t[10]=h*e-i*a,t[11]=v*e-c*a,t},M.rotateY=function(t,n,r){var a=Math.sin(r),e=Math.cos(r),u=n[0],o=n[1],i=n[2],c=n[3],f=n[8],s=n[9],h=n[10],v=n[11];return n!==t&&(t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=u*e-f*a,t[1]=o*e-s*a,t[2]=i*e-h*a,t[3]=c*e-v*a,t[8]=u*a+f*e,t[9]=o*a+s*e,t[10]=i*a+h*e,t[11]=c*a+v*e,t},M.rotateZ=function(t,n,r){var a=Math.sin(r),e=Math.cos(r),u=n[0],o=n[1],i=n[2],c=n[3],f=n[4],s=n[5],h=n[6],v=n[7];return n!==t&&(t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=u*e+f*a,t[1]=o*e+s*a,t[2]=i*e+h*a,t[3]=c*e+v*a,t[4]=f*e-u*a,t[5]=s*e-o*a,t[6]=h*e-i*a,t[7]=v*e-c*a,t},M.fromRotationTranslation=function(t,n,r){var a=n[0],e=n[1],u=n[2],o=n[3],i=a+a,c=e+e,f=u+u,s=a*i,h=a*c,v=a*f,M=e*c,l=e*f,d=u*f,m=o*i,p=o*c,w=o*f;return t[0]=1-(M+d),t[1]=h+w,t[2]=v-p,t[3]=0,t[4]=h-w,t[5]=1-(s+d),t[6]=l+m,t[7]=0,t[8]=v+p,t[9]=l-m,t[10]=1-(s+M),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},M.fromQuat=function(t,n){var r=n[0],a=n[1],e=n[2],u=n[3],o=r+r,i=a+a,c=e+e,f=r*o,s=a*o,h=a*i,v=e*o,M=e*i,l=e*c,d=u*o,m=u*i,p=u*c;return t[0]=1-h-l,t[1]=s+p,t[2]=v-m,t[3]=0,t[4]=s-p,t[5]=1-f-l,t[6]=M+d,t[7]=0,t[8]=v+m,t[9]=M-d,t[10]=1-f-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},M.frustum=function(t,n,r,a,e,u,o){var i=1/(r-n),c=1/(e-a),f=1/(u-o);return t[0]=2*u*i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*u*c,t[6]=0,t[7]=0,t[8]=(r+n)*i,t[9]=(e+a)*c,t[10]=(o+u)*f,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*u*2*f,t[15]=0,t},M.perspective=function(t,n,r,a,e){var u=1/Math.tan(n/2),o=1/(a-e);return t[0]=u/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(e+a)*o,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*e*a*o,t[15]=0,t},M.ortho=function(t,n,r,a,e,u,o){var i=1/(n-r),c=1/(a-e),f=1/(u-o);return t[0]=-2*i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*f,t[11]=0,t[12]=(n+r)*i,t[13]=(e+a)*c,t[14]=(o+u)*f,t[15]=1,t},M.lookAt=function(t,r,a,e){var u,o,i,c,f,s,h,v,l,d,m=r[0],p=r[1],w=r[2],q=e[0],y=e[1],g=e[2],x=a[0],b=a[1],A=a[2];return Math.abs(m-x)<n&&Math.abs(p-b)<n&&Math.abs(w-A)<n?M.identity(t):(h=m-x,v=p-b,l=w-A,u=y*(l*=d=1/Math.sqrt(h*h+v*v+l*l))-g*(v*=d),o=g*(h*=d)-q*l,i=q*v-y*h,(d=Math.sqrt(u*u+o*o+i*i))?(u*=d=1/d,o*=d,i*=d):(u=0,o=0,i=0),c=v*i-l*o,f=l*u-h*i,s=h*o-v*u,(d=Math.sqrt(c*c+f*f+s*s))?(c*=d=1/d,f*=d,s*=d):(c=0,f=0,s=0),t[0]=u,t[1]=c,t[2]=h,t[3]=0,t[4]=o,t[5]=f,t[6]=v,t[7]=0,t[8]=i,t[9]=s,t[10]=l,t[11]=0,t[12]=-(u*m+o*p+i*w),t[13]=-(c*m+f*p+s*w),t[14]=-(h*m+v*p+l*w),t[15]=1,t)},M.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},M.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},void 0!==t&&(t.mat4=M);var l,d,m,p,w={};w.create=function(){var t=new r(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},w.rotationTo=(l=c.create(),d=c.fromValues(1,0,0),m=c.fromValues(0,1,0),function(t,n,r){var a=c.dot(n,r);return a<-.999999?(c.cross(l,d,n),c.length(l)<1e-6&&c.cross(l,m,n),c.normalize(l,l),w.setAxisAngle(t,l,Math.PI),t):a>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(c.cross(l,n,r),t[0]=l[0],t[1]=l[1],t[2]=l[2],t[3]=1+a,w.normalize(t,t))}),w.setAxes=(p=v.create(),function(t,n,r,a){return p[0]=r[0],p[3]=r[1],p[6]=r[2],p[1]=a[0],p[4]=a[1],p[7]=a[2],p[2]=-n[0],p[5]=-n[1],p[8]=-n[2],w.normalize(t,w.fromMat3(t,p))}),w.clone=f.clone,w.fromValues=f.fromValues,w.copy=f.copy,w.set=f.set,w.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},w.setAxisAngle=function(t,n,r){r*=.5;var a=Math.sin(r);return t[0]=a*n[0],t[1]=a*n[1],t[2]=a*n[2],t[3]=Math.cos(r),t},w.add=f.add,w.multiply=function(t,n,r){var a=n[0],e=n[1],u=n[2],o=n[3],i=r[0],c=r[1],f=r[2],s=r[3];return t[0]=a*s+o*i+e*f-u*c,t[1]=e*s+o*c+u*i-a*f,t[2]=u*s+o*f+a*c-e*i,t[3]=o*s-a*i-e*c-u*f,t},w.mul=w.multiply,w.scale=f.scale,w.rotateX=function(t,n,r){r*=.5;var a=n[0],e=n[1],u=n[2],o=n[3],i=Math.sin(r),c=Math.cos(r);return t[0]=a*c+o*i,t[1]=e*c+u*i,t[2]=u*c-e*i,t[3]=o*c-a*i,t},w.rotateY=function(t,n,r){r*=.5;var a=n[0],e=n[1],u=n[2],o=n[3],i=Math.sin(r),c=Math.cos(r);return t[0]=a*c-u*i,t[1]=e*c+o*i,t[2]=u*c+a*i,t[3]=o*c-e*i,t},w.rotateZ=function(t,n,r){r*=.5;var a=n[0],e=n[1],u=n[2],o=n[3],i=Math.sin(r),c=Math.cos(r);return t[0]=a*c+e*i,t[1]=e*c-a*i,t[2]=u*c+o*i,t[3]=o*c-u*i,t},w.calculateW=function(t,n){var r=n[0],a=n[1],e=n[2];return t[0]=r,t[1]=a,t[2]=e,t[3]=-Math.sqrt(Math.abs(1-r*r-a*a-e*e)),t},w.dot=f.dot,w.lerp=f.lerp,w.slerp=function(t,n,r,a){var e,u,o,i,c,f=n[0],s=n[1],h=n[2],v=n[3],M=r[0],l=r[1],d=r[2],m=r[3];return(u=f*M+s*l+h*d+v*m)<0&&(u=-u,M=-M,l=-l,d=-d,m=-m),1-u>1e-6?(e=Math.acos(u),o=Math.sin(e),i=Math.sin((1-a)*e)/o,c=Math.sin(a*e)/o):(i=1-a,c=a),t[0]=i*f+c*M,t[1]=i*s+c*l,t[2]=i*h+c*d,t[3]=i*v+c*m,t},w.invert=function(t,n){var r=n[0],a=n[1],e=n[2],u=n[3],o=r*r+a*a+e*e+u*u,i=o?1/o:0;return t[0]=-r*i,t[1]=-a*i,t[2]=-e*i,t[3]=u*i,t},w.conjugate=function(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=n[3],t},w.length=f.length,w.len=w.length,w.squaredLength=f.squaredLength,w.sqrLen=w.squaredLength,w.normalize=f.normalize,w.fromMat3=function(t,n){var r,a=n[0]+n[4]+n[8];if(a>0)r=Math.sqrt(a+1),t[3]=.5*r,r=.5/r,t[0]=(n[7]-n[5])*r,t[1]=(n[2]-n[6])*r,t[2]=(n[3]-n[1])*r;else{var e=0;n[4]>n[0]&&(e=1),n[8]>n[3*e+e]&&(e=2);var u=(e+1)%3,o=(e+2)%3;r=Math.sqrt(n[3*e+e]-n[3*u+u]-n[3*o+o]+1),t[e]=.5*r,r=.5/r,t[3]=(n[3*o+u]-n[3*u+o])*r,t[u]=(n[3*u+e]+n[3*e+u])*r,t[o]=(n[3*o+e]+n[3*e+o])*r}return t},w.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},void 0!==t&&(t.quat=w)}(r.exports)}(this);
},{}],"GFDe":[function(require,module,exports) {
var i=require("gl-matrix"),t=i.vec3,h=module.exports=function(i){this.valid=!0,this.id=i.id,this.handId=i.handId,this.length=i.length,this.tool=i.tool,this.width=i.width,this.direction=i.direction,this.stabilizedTipPosition=i.stabilizedTipPosition,this.tipPosition=i.tipPosition,this.tipVelocity=i.tipVelocity,this.touchZone=i.touchZone,this.touchDistance=i.touchDistance,this.timeVisible=i.timeVisible};h.prototype.toString=function(){return"Pointable [ id:"+this.id+" "+this.length+"mmx | width:"+this.width+"mm | direction:"+this.direction+" ]"},h.prototype.hand=function(){return this.frame.hand(this.handId)},h.Invalid={valid:!1};
},{"gl-matrix":"oY0f"}],"s12q":[function(require,module,exports) {
(function(){var n=this,t=n._,r={},e=Array.prototype,u=Object.prototype,i=Function.prototype,a=e.push,c=e.slice,o=e.concat,l=u.toString,f=u.hasOwnProperty,s=e.forEach,p=e.map,h=e.reduce,v=e.reduceRight,d=e.filter,y=e.every,g=e.some,m=e.indexOf,b=e.lastIndexOf,x=Array.isArray,_=Object.keys,j=i.bind,w=function(n){return n instanceof w?n:this instanceof w?void(this._wrapped=n):new w(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=w),exports._=w):n._=w,w.VERSION="1.4.4";var A=w.each=w.forEach=function(n,t,e){if(null!=n)if(s&&n.forEach===s)n.forEach(t,e);else if(n.length===+n.length){for(var u=0,i=n.length;u<i;u++)if(t.call(e,n[u],u,n)===r)return}else for(var a in n)if(w.has(n,a)&&t.call(e,n[a],a,n)===r)return};w.map=w.collect=function(n,t,r){var e=[];return null==n?e:p&&n.map===p?n.map(t,r):(A(n,function(n,u,i){e[e.length]=t.call(r,n,u,i)}),e)};var O="Reduce of empty array with no initial value";w.reduce=w.foldl=w.inject=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),h&&n.reduce===h)return e&&(t=w.bind(t,e)),u?n.reduce(t,r):n.reduce(t);if(A(n,function(n,i,a){u?r=t.call(e,r,n,i,a):(r=n,u=!0)}),!u)throw new TypeError(O);return r},w.reduceRight=w.foldr=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),v&&n.reduceRight===v)return e&&(t=w.bind(t,e)),u?n.reduceRight(t,r):n.reduceRight(t);var i=n.length;if(i!==+i){var a=w.keys(n);i=a.length}if(A(n,function(c,o,l){o=a?a[--i]:--i,u?r=t.call(e,r,n[o],o,l):(r=n[o],u=!0)}),!u)throw new TypeError(O);return r},w.find=w.detect=function(n,t,r){var e;return E(n,function(n,u,i){if(t.call(r,n,u,i))return e=n,!0}),e},w.filter=w.select=function(n,t,r){var e=[];return null==n?e:d&&n.filter===d?n.filter(t,r):(A(n,function(n,u,i){t.call(r,n,u,i)&&(e[e.length]=n)}),e)},w.reject=function(n,t,r){return w.filter(n,function(n,e,u){return!t.call(r,n,e,u)},r)},w.every=w.all=function(n,t,e){t||(t=w.identity);var u=!0;return null==n?u:y&&n.every===y?n.every(t,e):(A(n,function(n,i,a){if(!(u=u&&t.call(e,n,i,a)))return r}),!!u)};var E=w.some=w.any=function(n,t,e){t||(t=w.identity);var u=!1;return null==n?u:g&&n.some===g?n.some(t,e):(A(n,function(n,i,a){if(u||(u=t.call(e,n,i,a)))return r}),!!u)};w.contains=w.include=function(n,t){return null!=n&&(m&&n.indexOf===m?-1!=n.indexOf(t):E(n,function(n){return n===t}))},w.invoke=function(n,t){var r=c.call(arguments,2),e=w.isFunction(t);return w.map(n,function(n){return(e?t:n[t]).apply(n,r)})},w.pluck=function(n,t){return w.map(n,function(n){return n[t]})},w.where=function(n,t,r){return w.isEmpty(t)?r?null:[]:w[r?"find":"filter"](n,function(n){for(var r in t)if(t[r]!==n[r])return!1;return!0})},w.findWhere=function(n,t){return w.where(n,t,!0)},w.max=function(n,t,r){if(!t&&w.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.max.apply(Math,n);if(!t&&w.isEmpty(n))return-1/0;var e={computed:-1/0,value:-1/0};return A(n,function(n,u,i){var a=t?t.call(r,n,u,i):n;a>=e.computed&&(e={value:n,computed:a})}),e.value},w.min=function(n,t,r){if(!t&&w.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.min.apply(Math,n);if(!t&&w.isEmpty(n))return 1/0;var e={computed:1/0,value:1/0};return A(n,function(n,u,i){var a=t?t.call(r,n,u,i):n;a<e.computed&&(e={value:n,computed:a})}),e.value},w.shuffle=function(n){var t,r=0,e=[];return A(n,function(n){t=w.random(r++),e[r-1]=e[t],e[t]=n}),e};var k=function(n){return w.isFunction(n)?n:function(t){return t[n]}};w.sortBy=function(n,t,r){var e=k(t);return w.pluck(w.map(n,function(n,t,u){return{value:n,index:t,criteria:e.call(r,n,t,u)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;if(r!==e){if(r>e||void 0===r)return 1;if(r<e||void 0===e)return-1}return n.index<t.index?-1:1}),"value")};var F=function(n,t,r,e){var u={},i=k(t||w.identity);return A(n,function(t,a){var c=i.call(r,t,a,n);e(u,c,t)}),u};w.groupBy=function(n,t,r){return F(n,t,r,function(n,t,r){(w.has(n,t)?n[t]:n[t]=[]).push(r)})},w.countBy=function(n,t,r){return F(n,t,r,function(n,t){w.has(n,t)||(n[t]=0),n[t]++})},w.sortedIndex=function(n,t,r,e){for(var u=(r=null==r?w.identity:k(r)).call(e,t),i=0,a=n.length;i<a;){var c=i+a>>>1;r.call(e,n[c])<u?i=c+1:a=c}return i},w.toArray=function(n){return n?w.isArray(n)?c.call(n):n.length===+n.length?w.map(n,w.identity):w.values(n):[]},w.size=function(n){return null==n?0:n.length===+n.length?n.length:w.keys(n).length},w.first=w.head=w.take=function(n,t,r){if(null!=n)return null==t||r?n[0]:c.call(n,0,t)},w.initial=function(n,t,r){return c.call(n,0,n.length-(null==t||r?1:t))},w.last=function(n,t,r){if(null!=n)return null==t||r?n[n.length-1]:c.call(n,Math.max(n.length-t,0))},w.rest=w.tail=w.drop=function(n,t,r){return c.call(n,null==t||r?1:t)},w.compact=function(n){return w.filter(n,w.identity)};var R=function(n,t,r){return A(n,function(n){w.isArray(n)?t?a.apply(r,n):R(n,t,r):r.push(n)}),r};w.flatten=function(n,t){return R(n,t,[])},w.without=function(n){return w.difference(n,c.call(arguments,1))},w.uniq=w.unique=function(n,t,r,e){w.isFunction(t)&&(e=r,r=t,t=!1);var u=r?w.map(n,r,e):n,i=[],a=[];return A(u,function(r,e){(t?e&&a[a.length-1]===r:w.contains(a,r))||(a.push(r),i.push(n[e]))}),i},w.union=function(){return w.uniq(o.apply(e,arguments))},w.intersection=function(n){var t=c.call(arguments,1);return w.filter(w.uniq(n),function(n){return w.every(t,function(t){return w.indexOf(t,n)>=0})})},w.difference=function(n){var t=o.apply(e,c.call(arguments,1));return w.filter(n,function(n){return!w.contains(t,n)})},w.zip=function(){for(var n=c.call(arguments),t=w.max(w.pluck(n,"length")),r=new Array(t),e=0;e<t;e++)r[e]=w.pluck(n,""+e);return r},w.object=function(n,t){if(null==n)return{};for(var r={},e=0,u=n.length;e<u;e++)t?r[n[e]]=t[e]:r[n[e][0]]=n[e][1];return r},w.indexOf=function(n,t,r){if(null==n)return-1;var e=0,u=n.length;if(r){if("number"!=typeof r)return n[e=w.sortedIndex(n,t)]===t?e:-1;e=r<0?Math.max(0,u+r):r}if(m&&n.indexOf===m)return n.indexOf(t,r);for(;e<u;e++)if(n[e]===t)return e;return-1},w.lastIndexOf=function(n,t,r){if(null==n)return-1;var e=null!=r;if(b&&n.lastIndexOf===b)return e?n.lastIndexOf(t,r):n.lastIndexOf(t);for(var u=e?r:n.length;u--;)if(n[u]===t)return u;return-1},w.range=function(n,t,r){arguments.length<=1&&(t=n||0,n=0),r=arguments[2]||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=0,i=new Array(e);u<e;)i[u++]=n,n+=r;return i},w.bind=function(n,t){if(n.bind===j&&j)return j.apply(n,c.call(arguments,1));var r=c.call(arguments,2);return function(){return n.apply(t,r.concat(c.call(arguments)))}},w.partial=function(n){var t=c.call(arguments,1);return function(){return n.apply(this,t.concat(c.call(arguments)))}},w.bindAll=function(n){var t=c.call(arguments,1);return 0===t.length&&(t=w.functions(n)),A(t,function(t){n[t]=w.bind(n[t],n)}),n},w.memoize=function(n,t){var r={};return t||(t=w.identity),function(){var e=t.apply(this,arguments);return w.has(r,e)?r[e]:r[e]=n.apply(this,arguments)}},w.delay=function(n,t){var r=c.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},t)},w.defer=function(n){return w.delay.apply(w,[n,1].concat(c.call(arguments,1)))},w.throttle=function(n,t){var r,e,u,i,a=0,c=function(){a=new Date,u=null,i=n.apply(r,e)};return function(){var o=new Date,l=t-(o-a);return r=this,e=arguments,l<=0?(clearTimeout(u),u=null,a=o,i=n.apply(r,e)):u||(u=setTimeout(c,l)),i}},w.debounce=function(n,t,r){var e,u;return function(){var i=this,a=arguments,c=r&&!e;return clearTimeout(e),e=setTimeout(function(){e=null,r||(u=n.apply(i,a))},t),c&&(u=n.apply(i,a)),u}},w.once=function(n){var t,r=!1;return function(){return r?t:(r=!0,t=n.apply(this,arguments),n=null,t)}},w.wrap=function(n,t){return function(){var r=[n];return a.apply(r,arguments),t.apply(this,r)}},w.compose=function(){var n=arguments;return function(){for(var t=arguments,r=n.length-1;r>=0;r--)t=[n[r].apply(this,t)];return t[0]}},w.after=function(n,t){return n<=0?t():function(){if(--n<1)return t.apply(this,arguments)}},w.keys=_||function(n){if(n!==Object(n))throw new TypeError("Invalid object");var t=[];for(var r in n)w.has(n,r)&&(t[t.length]=r);return t},w.values=function(n){var t=[];for(var r in n)w.has(n,r)&&t.push(n[r]);return t},w.pairs=function(n){var t=[];for(var r in n)w.has(n,r)&&t.push([r,n[r]]);return t},w.invert=function(n){var t={};for(var r in n)w.has(n,r)&&(t[n[r]]=r);return t},w.functions=w.methods=function(n){var t=[];for(var r in n)w.isFunction(n[r])&&t.push(r);return t.sort()},w.extend=function(n){return A(c.call(arguments,1),function(t){if(t)for(var r in t)n[r]=t[r]}),n},w.pick=function(n){var t={},r=o.apply(e,c.call(arguments,1));return A(r,function(r){r in n&&(t[r]=n[r])}),t},w.omit=function(n){var t={},r=o.apply(e,c.call(arguments,1));for(var u in n)w.contains(r,u)||(t[u]=n[u]);return t},w.defaults=function(n){return A(c.call(arguments,1),function(t){if(t)for(var r in t)null==n[r]&&(n[r]=t[r])}),n},w.clone=function(n){return w.isObject(n)?w.isArray(n)?n.slice():w.extend({},n):n},w.tap=function(n,t){return t(n),n};var S=function(n,t,r,e){if(n===t)return 0!==n||1/n==1/t;if(null==n||null==t)return n===t;n instanceof w&&(n=n._wrapped),t instanceof w&&(t=t._wrapped);var u=l.call(n);if(u!=l.call(t))return!1;switch(u){case"[object String]":return n==String(t);case"[object Number]":return n!=+n?t!=+t:0==n?1/n==1/t:n==+t;case"[object Date]":case"[object Boolean]":return+n==+t;case"[object RegExp]":return n.source==t.source&&n.global==t.global&&n.multiline==t.multiline&&n.ignoreCase==t.ignoreCase}if("object"!=typeof n||"object"!=typeof t)return!1;for(var i=r.length;i--;)if(r[i]==n)return e[i]==t;r.push(n),e.push(t);var a=0,c=!0;if("[object Array]"==u){if(c=(a=n.length)==t.length)for(;a--&&(c=S(n[a],t[a],r,e)););}else{var o=n.constructor,f=t.constructor;if(o!==f&&!(w.isFunction(o)&&o instanceof o&&w.isFunction(f)&&f instanceof f))return!1;for(var s in n)if(w.has(n,s)&&(a++,!(c=w.has(t,s)&&S(n[s],t[s],r,e))))break;if(c){for(s in t)if(w.has(t,s)&&!a--)break;c=!a}}return r.pop(),e.pop(),c};w.isEqual=function(n,t){return S(n,t,[],[])},w.isEmpty=function(n){if(null==n)return!0;if(w.isArray(n)||w.isString(n))return 0===n.length;for(var t in n)if(w.has(n,t))return!1;return!0},w.isElement=function(n){return!(!n||1!==n.nodeType)},w.isArray=x||function(n){return"[object Array]"==l.call(n)},w.isObject=function(n){return n===Object(n)},A(["Arguments","Function","String","Number","Date","RegExp"],function(n){w["is"+n]=function(t){return l.call(t)=="[object "+n+"]"}}),w.isArguments(arguments)||(w.isArguments=function(n){return!(!n||!w.has(n,"callee"))}),"function"!=typeof/./&&(w.isFunction=function(n){return"function"==typeof n}),w.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},w.isNaN=function(n){return w.isNumber(n)&&n!=+n},w.isBoolean=function(n){return!0===n||!1===n||"[object Boolean]"==l.call(n)},w.isNull=function(n){return null===n},w.isUndefined=function(n){return void 0===n},w.has=function(n,t){return f.call(n,t)},w.noConflict=function(){return n._=t,this},w.identity=function(n){return n},w.times=function(n,t,r){for(var e=Array(n),u=0;u<n;u++)e[u]=t.call(r,u);return e},w.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};I.unescape=w.invert(I.escape);var M={escape:new RegExp("["+w.keys(I.escape).join("")+"]","g"),unescape:new RegExp("("+w.keys(I.unescape).join("|")+")","g")};w.each(["escape","unescape"],function(n){w[n]=function(t){return null==t?"":(""+t).replace(M[n],function(t){return I[n][t]})}}),w.result=function(n,t){if(null==n)return null;var r=n[t];return w.isFunction(r)?r.call(n):r},w.mixin=function(n){A(w.functions(n),function(t){var r=w[t]=n[t];w.prototype[t]=function(){var n=[this._wrapped];return a.apply(n,arguments),D.call(this,r.apply(w,n))}})};var N=0;w.uniqueId=function(n){var t=++N+"";return n?n+t:t},w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var T=/(.)^/,q={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},B=/\\|'|\r|\n|\t|\u2028|\u2029/g;w.template=function(n,t,r){var e;r=w.defaults({},r,w.templateSettings);var u=new RegExp([(r.escape||T).source,(r.interpolate||T).source,(r.evaluate||T).source].join("|")+"|$","g"),i=0,a="__p+='";n.replace(u,function(t,r,e,u,c){return a+=n.slice(i,c).replace(B,function(n){return"\\"+q[n]}),r&&(a+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'"),e&&(a+="'+\n((__t=("+e+"))==null?'':__t)+\n'"),u&&(a+="';\n"+u+"\n__p+='"),i=c+t.length,t}),a+="';\n",r.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{e=new Function(r.variable||"obj","_",a)}catch(n){throw n.source=a,n}if(t)return e(t,w);var c=function(n){return e.call(this,n,w)};return c.source="function("+(r.variable||"obj")+"){\n"+a+"}",c},w.chain=function(n){return w(n).chain()};var D=function(n){return this._chain?w(n).chain():n};w.mixin(w),A(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=e[n];w.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!=n&&"splice"!=n||0!==r.length||delete r[0],D.call(this,r)}}),A(["concat","join","slice"],function(n){var t=e[n];w.prototype[n]=function(){return D.call(this,t.apply(this._wrapped,arguments))}}),w.extend(w.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this);
},{}],"k9ew":[function(require,module,exports) {
var t=require("./pointable"),i=require("gl-matrix"),e=i.vec3,r=i.mat3,s=i.mat4,n=require("underscore"),h=module.exports=function(t,i){this.finger=t,this._center=null,this._matrix=null,this.type=i.type,this.prevJoint=i.prevJoint,this.nextJoint=i.nextJoint,this.width=i.width;var r=new Array(3);e.sub(r,i.nextJoint,i.prevJoint),this.length=e.length(r),this.basis=i.basis};h.prototype.left=function(){return this._left?this._left:(this._left=r.determinant(this.basis[0].concat(this.basis[1]).concat(this.basis[2]))<0,this._left)},h.prototype.matrix=function(){if(this._matrix)return this._matrix;var t=this.basis,i=this._matrix=s.create();return i[0]=t[0][0],i[1]=t[0][1],i[2]=t[0][2],i[4]=t[1][0],i[5]=t[1][1],i[6]=t[1][2],i[8]=t[2][0],i[9]=t[2][1],i[10]=t[2][2],i[3]=this.center()[0],i[7]=this.center()[1],i[11]=this.center()[2],this.left()&&(i[0]*=-1,i[1]*=-1,i[2]*=-1),this._matrix},h.prototype.lerp=function(t,i){e.lerp(t,this.prevJoint,this.nextJoint,i)},h.prototype.center=function(){if(this._center)return this._center;var t=e.create();return this.lerp(t,.5),this._center=t,t},h.prototype.direction=function(){return[-1*this.basis[2][0],-1*this.basis[2][1],-1*this.basis[2][2]]};
},{"./pointable":"GFDe","gl-matrix":"oY0f","underscore":"s12q"}],"N2Qt":[function(require,module,exports) {
var t=require("./pointable"),i=require("./bone"),r=require("gl-matrix"),n=r.mat3,a=r.vec3,e=require("underscore"),o=module.exports=function(t){this.id=t.id,this.palmPosition=t.palmPosition,this.direction=t.direction,this.palmVelocity=t.palmVelocity,this.palmNormal=t.palmNormal,this.sphereCenter=t.sphereCenter,this.sphereRadius=t.sphereRadius,this.valid=!0,this.pointables=[],this.fingers=[],t.armBasis?this.arm=new i(this,{type:4,width:t.armWidth,prevJoint:t.elbow,nextJoint:t.wrist,basis:t.armBasis}):this.arm=null,this.tools=[],this._translation=t.t,this._rotation=e.flatten(t.r),this._scaleFactor=t.s,this.timeVisible=t.timeVisible,this.stabilizedPalmPosition=t.stabilizedPalmPosition,this.type=t.type,this.grabStrength=t.grabStrength,this.pinchStrength=t.pinchStrength,this.confidence=t.confidence};o.prototype.finger=function(i){var r=this.frame.finger(i);return r&&r.handId==this.id?r:t.Invalid},o.prototype.rotationAngle=function(t,i){if(!this.valid||!t.valid)return 0;if(!t.hand(this.id).valid)return 0;var r=this.rotationMatrix(t),n=.5*(r[0]+r[4]+r[8]-1),e=Math.acos(n);if(e=isNaN(e)?0:e,void 0!==i){var o=this.rotationAxis(t);e*=a.dot(o,a.normalize(a.create(),i))}return e},o.prototype.rotationAxis=function(t){if(!this.valid||!t.valid)return a.create();var i=t.hand(this.id);return i.valid?a.normalize(a.create(),[this._rotation[7]-i._rotation[5],this._rotation[2]-i._rotation[6],this._rotation[3]-i._rotation[1]]):a.create()},o.prototype.rotationMatrix=function(t){if(!this.valid||!t.valid)return n.create();var i=t.hand(this.id);if(!i.valid)return n.create();var r=n.transpose(n.create(),this._rotation);return n.multiply(n.create(),i._rotation,r)},o.prototype.scaleFactor=function(t){if(!this.valid||!t.valid)return 1;var i=t.hand(this.id);return i.valid?Math.exp(this._scaleFactor-i._scaleFactor):1},o.prototype.translation=function(t){if(!this.valid||!t.valid)return a.create();var i=t.hand(this.id);return i.valid?[this._translation[0]-i._translation[0],this._translation[1]-i._translation[1],this._translation[2]-i._translation[2]]:a.create()},o.prototype.toString=function(){return"Hand ("+this.type+") [ id: "+this.id+" | palm velocity:"+this.palmVelocity+" | sphere center:"+this.sphereCenter+" ] "},o.prototype.pitch=function(){return Math.atan2(this.direction[1],-this.direction[2])},o.prototype.yaw=function(){return Math.atan2(this.direction[0],-this.direction[2])},o.prototype.roll=function(){return Math.atan2(this.palmNormal[0],-this.palmNormal[1])},o.Invalid={valid:!1,fingers:[],tools:[],pointables:[],left:!1,pointable:function(){return t.Invalid},finger:function(){return t.Invalid},toString:function(){return"invalid frame"},dump:function(){return this.toString()},rotationAngle:function(){return 0},rotationMatrix:function(){return n.create()},rotationAxis:function(){return a.create()},scaleFactor:function(){return 1},translation:function(){return a.create()}};
},{"./pointable":"GFDe","./bone":"k9ew","gl-matrix":"oY0f","underscore":"s12q"}],"Bmcw":[function(require,module,exports) {
function e(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function t(e){return"function"==typeof e}function s(e){return"number"==typeof e}function n(e){return"object"==typeof e&&null!==e}function i(e){return void 0===e}module.exports=e,e.EventEmitter=e,e.prototype._events=void 0,e.prototype._maxListeners=void 0,e.defaultMaxListeners=10,e.prototype.setMaxListeners=function(e){if(!s(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},e.prototype.emit=function(e){var s,r,o,h,v,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||n(this._events.error)&&!this._events.error.length)){if((s=arguments[1])instanceof Error)throw s;var u=new Error('Uncaught, unspecified "error" event. ('+s+")");throw u.context=s,u}if(i(r=this._events[e]))return!1;if(t(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:h=Array.prototype.slice.call(arguments,1),r.apply(this,h)}else if(n(r))for(h=Array.prototype.slice.call(arguments,1),o=(l=r.slice()).length,v=0;v<o;v++)l[v].apply(this,h);return!0},e.prototype.addListener=function(s,r){var o;if(!t(r))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",s,t(r.listener)?r.listener:r),this._events[s]?n(this._events[s])?this._events[s].push(r):this._events[s]=[this._events[s],r]:this._events[s]=r,n(this._events[s])&&!this._events[s].warned&&(o=i(this._maxListeners)?e.defaultMaxListeners:this._maxListeners)&&o>0&&this._events[s].length>o&&(this._events[s].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[s].length),"function"==typeof console.trace&&console.trace()),this},e.prototype.on=e.prototype.addListener,e.prototype.once=function(e,s){if(!t(s))throw TypeError("listener must be a function");var n=!1;function i(){this.removeListener(e,i),n||(n=!0,s.apply(this,arguments))}return i.listener=s,this.on(e,i),this},e.prototype.removeListener=function(e,s){var i,r,o,h;if(!t(s))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(o=(i=this._events[e]).length,r=-1,i===s||t(i.listener)&&i.listener===s)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,s);else if(n(i)){for(h=o;h-- >0;)if(i[h]===s||i[h].listener&&i[h].listener===s){r=h;break}if(r<0)return this;1===i.length?(i.length=0,delete this._events[e]):i.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,s)}return this},e.prototype.removeAllListeners=function(e){var s,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(s in this._events)"removeListener"!==s&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events={},this}if(t(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},e.prototype.listeners=function(e){return this._events&&this._events[e]?t(this._events[e])?[this._events[e]]:this._events[e].slice():[]},e.prototype.listenerCount=function(e){if(this._events){var s=this._events[e];if(t(s))return 1;if(s)return s.length}return 0},e.listenerCount=function(e,t){return e.listenerCount(t)};
},{}],"0zMq":[function(require,module,exports) {
var t=require("gl-matrix"),e=t.vec3,r=require("events").EventEmitter,i=require("underscore"),s=exports.createGesture=function(t){var e;switch(t.type){case"circle":e=new a(t);break;case"swipe":e=new u(t);break;case"screenTap":e=new p(t);break;case"keyTap":e=new c(t);break;default:throw"unknown gesture type"}return e.id=t.id,e.handIds=t.handIds.slice(),e.pointableIds=t.pointableIds.slice(),e.duration=t.duration,e.state=t.state,e.type=t.type,e},n=exports.gestureListener=function(t,e){var r={},s={};t.on("gesture",function(t,n){if(t.type==e){if(("start"==t.state||"stop"==t.state)&&void 0===s[t.id]){var a=new o(t,n);s[t.id]=a,i.each(r,function(t,e){a.on(e,t)})}s[t.id].update(t,n),"stop"==t.state&&delete s[t.id]}});var n={start:function(t){return r.start=t,n},stop:function(t){return r.stop=t,n},complete:function(t){return r.stop=t,n},update:function(t){return r.update=t,n}};return n},o=exports.Gesture=function(t,e){this.gestures=[t],this.frames=[e]};o.prototype.update=function(t,e){this.lastGesture=t,this.lastFrame=e,this.gestures.push(t),this.frames.push(e),this.emit(t.state,this)},o.prototype.translation=function(){return e.subtract(e.create(),this.lastGesture.startPosition,this.lastGesture.position)},i.extend(o.prototype,r.prototype);var a=function(t){this.center=t.center,this.normal=t.normal,this.progress=t.progress,this.radius=t.radius};a.prototype.toString=function(){return"CircleGesture ["+JSON.stringify(this)+"]"};var u=function(t){this.startPosition=t.startPosition,this.position=t.position,this.direction=t.direction,this.speed=t.speed};u.prototype.toString=function(){return"SwipeGesture ["+JSON.stringify(this)+"]"};var p=function(t){this.position=t.position,this.direction=t.direction,this.progress=t.progress};p.prototype.toString=function(){return"ScreenTapGesture ["+JSON.stringify(this)+"]"};var c=function(t){this.position=t.position,this.direction=t.direction,this.progress=t.progress};c.prototype.toString=function(){return"KeyTapGesture ["+JSON.stringify(this)+"]"};
},{"gl-matrix":"oY0f","events":"Bmcw","underscore":"s12q"}],"Sqgz":[function(require,module,exports) {
var t=require("gl-matrix"),i=t.vec3,e=module.exports=function(t){this.valid=!0,this.center=t.center,this.size=t.size,this.width=t.size[0],this.height=t.size[1],this.depth=t.size[2]};e.prototype.denormalizePoint=function(t){return i.fromValues((t[0]-.5)*this.size[0]+this.center[0],(t[1]-.5)*this.size[1]+this.center[1],(t[2]-.5)*this.size[2]+this.center[2])},e.prototype.normalizePoint=function(t,e){var h=i.fromValues((t[0]-this.center[0])/this.size[0]+.5,(t[1]-this.center[1])/this.size[1]+.5,(t[2]-this.center[2])/this.size[2]+.5);return e&&(h[0]=Math.min(Math.max(h[0],0),1),h[1]=Math.min(Math.max(h[1],0),1),h[2]=Math.min(Math.max(h[2],0),1)),h},e.prototype.toString=function(){return"InteractionBox [ width:"+this.width+" | height:"+this.height+" | depth:"+this.depth+" ]"},e.Invalid={valid:!1};
},{"gl-matrix":"oY0f"}],"v3go":[function(require,module,exports) {

var t,e,n=module.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}function u(t){if(e===clearTimeout)return clearTimeout(t);if((e===o||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(t);try{return e(t)}catch(n){try{return e.call(null,t)}catch(n){return e.call(this,t)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(e){t=r}try{e="function"==typeof clearTimeout?clearTimeout:o}catch(t){e=o}}();var c,s=[],l=!1,a=-1;function f(){l&&c&&(l=!1,c.length?s=c.concat(s):a=-1,s.length&&h())}function h(){if(!l){var t=i(f);l=!0;for(var e=s.length;e;){for(c=s,s=[];++a<e;)c&&c[a].run();a=-1,e=s.length}c=null,l=!1,u(t)}}function m(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new m(t,e)),1!==s.length||l||i(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0};
},{}],"iccX":[function(require,module,exports) {
var process = require("process");
var e=require("process"),t=module.exports=function(e,t){this.options=t||{},this.message=e,this.createElement()};t.prototype.createElement=function(){this.element=document.createElement("div"),this.element.className="leapjs-dialog",this.element.style.position="fixed",this.element.style.top="8px",this.element.style.left=0,this.element.style.right=0,this.element.style.textAlign="center",this.element.style.zIndex=1e3;var e=document.createElement("div");this.element.appendChild(e),e.style.className="leapjs-dialog",e.style.display="inline-block",e.style.margin="auto",e.style.padding="8px",e.style.color="#222",e.style.background="#eee",e.style.borderRadius="4px",e.style.border="1px solid #999",e.style.textAlign="left",e.style.cursor="pointer",e.style.whiteSpace="nowrap",e.style.transition="box-shadow 1s linear",e.innerHTML=this.message,this.options.onclick&&e.addEventListener("click",this.options.onclick),this.options.onmouseover&&e.addEventListener("mouseover",this.options.onmouseover),this.options.onmouseout&&e.addEventListener("mouseout",this.options.onmouseout),this.options.onmousemove&&e.addEventListener("mousemove",this.options.onmousemove)},t.prototype.show=function(){return document.body.appendChild(this.element),this},t.prototype.hide=function(){return document.body.removeChild(this.element),this},t.warnOutOfDate=function(e){e||(e={});var o="http://developer.leapmotion.com?";for(var n in e.returnTo=window.location.href,e)o+=n+"="+encodeURIComponent(e[n])+"&";var s;return(s=new t("This site requires Leap Motion Tracking V2.<button id='leapjs-accept-upgrade'  style='color: #444; transition: box-shadow 100ms linear; cursor: pointer; vertical-align: baseline; margin-left: 16px;'>Upgrade</button><button id='leapjs-decline-upgrade' style='color: #444; transition: box-shadow 100ms linear; cursor: pointer; vertical-align: baseline; margin-left: 8px; '>Not Now</button>",{onclick:function(e){if("leapjs-decline-upgrade"!=e.target.id){var t=window.open(o,"_blank","height=800,width=1000,location=1,menubar=1,resizable=1,status=1,toolbar=1,scrollbars=1");window.focus&&t.focus()}return s.hide(),!0},onmousemove:function(e){e.target==document.getElementById("leapjs-decline-upgrade")?(document.getElementById("leapjs-decline-upgrade").style.color="#000",document.getElementById("leapjs-decline-upgrade").style.boxShadow="0px 0px 2px #5daa00",document.getElementById("leapjs-accept-upgrade").style.color="#444",document.getElementById("leapjs-accept-upgrade").style.boxShadow="none"):(document.getElementById("leapjs-accept-upgrade").style.color="#000",document.getElementById("leapjs-accept-upgrade").style.boxShadow="0px 0px 2px #5daa00",document.getElementById("leapjs-decline-upgrade").style.color="#444",document.getElementById("leapjs-decline-upgrade").style.boxShadow="none")},onmouseout:function(){document.getElementById("leapjs-decline-upgrade").style.color="#444",document.getElementById("leapjs-decline-upgrade").style.boxShadow="none",document.getElementById("leapjs-accept-upgrade").style.color="#444",document.getElementById("leapjs-accept-upgrade").style.boxShadow="none"}})).show()},t.hasWarnedBones=!1,t.warnBones=function(){this.hasWarnedBones||(this.hasWarnedBones=!0,console.warn("Your Leap Service is out of date"),void 0!==e&&e.versions&&e.versions.node||this.warnOutOfDate({reason:"bones"}))};
},{"process":"v3go"}],"9c+E":[function(require,module,exports) {
var i=require("./pointable"),t=require("./bone"),s=require("./dialog"),o=require("underscore"),e=module.exports=function(t){i.call(this,t),this.dipPosition=t.dipPosition,this.pipPosition=t.pipPosition,this.mcpPosition=t.mcpPosition,this.carpPosition=t.carpPosition,this.extended=t.extended,this.type=t.type,this.finger=!0,this.positions=[this.carpPosition,this.mcpPosition,this.pipPosition,this.dipPosition,this.tipPosition],t.bases?this.addBones(t):s.warnBones()};o.extend(e.prototype,i.prototype),e.prototype.addBones=function(i){this.metacarpal=new t(this,{type:0,width:this.width,prevJoint:this.carpPosition,nextJoint:this.mcpPosition,basis:i.bases[0]}),this.proximal=new t(this,{type:1,width:this.width,prevJoint:this.mcpPosition,nextJoint:this.pipPosition,basis:i.bases[1]}),this.medial=new t(this,{type:2,width:this.width,prevJoint:this.pipPosition,nextJoint:this.dipPosition,basis:i.bases[2]}),this.distal=new t(this,{type:3,width:this.width,prevJoint:this.dipPosition,nextJoint:i.btipPosition,basis:i.bases[3]}),this.bones=[this.metacarpal,this.proximal,this.medial,this.distal]},e.prototype.toString=function(){return"Finger [ id:"+this.id+" "+this.length+"mmx | width:"+this.width+"mm | direction:"+this.direction+" ]"},e.Invalid={valid:!1};
},{"./pointable":"GFDe","./bone":"k9ew","./dialog":"iccX","underscore":"s12q"}],"iOWN":[function(require,module,exports) {
var t=require("./hand"),i=require("./pointable"),r=require("./gesture").createGesture,n=require("gl-matrix"),e=n.mat3,a=n.vec3,o=require("./interaction_box"),s=require("./finger"),h=require("underscore"),u=module.exports=function(t){if(this.valid=!0,this.id=t.id,this.timestamp=t.timestamp,this.hands=[],this.handsMap={},this.pointables=[],this.tools=[],this.fingers=[],t.interactionBox&&(this.interactionBox=new o(t.interactionBox)),this.gestures=[],this.pointablesMap={},this._translation=t.t,this._rotation=h.flatten(t.r),this._scaleFactor=t.s,this.data=t,this.type="frame",this.currentFrameRate=t.currentFrameRate,t.gestures)for(var i=0,n=t.gestures.length;i!=n;i++)this.gestures.push(r(t.gestures[i]));this.postprocessData(t)};u.prototype.postprocessData=function(r){r||(r=this.data);for(var n=0,e=r.hands.length;n!=e;n++){var a=new t(r.hands[n]);a.frame=this,this.hands.push(a),this.handsMap[a.id]=a}r.pointables=h.sortBy(r.pointables,function(t){return t.id});for(var o=0,u=r.pointables.length;o!=u;o++){var l=r.pointables[o],p=l.dipPosition?new s(l):new i(l);p.frame=this,this.addPointable(p)}},u.prototype.addPointable=function(t){if(this.pointables.push(t),this.pointablesMap[t.id]=t,(t.tool?this.tools:this.fingers).push(t),void 0!==t.handId&&this.handsMap.hasOwnProperty(t.handId)){var i=this.handsMap[t.handId];switch(i.pointables.push(t),(t.tool?i.tools:i.fingers).push(t),t.type){case 0:i.thumb=t;break;case 1:i.indexFinger=t;break;case 2:i.middleFinger=t;break;case 3:i.ringFinger=t;break;case 4:i.pinky=t}}},u.prototype.tool=function(t){var r=this.pointable(t);return r.tool?r:i.Invalid},u.prototype.pointable=function(t){return this.pointablesMap[t]||i.Invalid},u.prototype.finger=function(t){var r=this.pointable(t);return r.tool?i.Invalid:r},u.prototype.hand=function(i){return this.handsMap[i]||t.Invalid},u.prototype.rotationAngle=function(t,i){if(!this.valid||!t.valid)return 0;var r=this.rotationMatrix(t),n=.5*(r[0]+r[4]+r[8]-1),e=Math.acos(n);if(e=isNaN(e)?0:e,void 0!==i){var o=this.rotationAxis(t);e*=a.dot(o,a.normalize(a.create(),i))}return e},u.prototype.rotationAxis=function(t){return this.valid&&t.valid?a.normalize(a.create(),[this._rotation[7]-t._rotation[5],this._rotation[2]-t._rotation[6],this._rotation[3]-t._rotation[1]]):a.create()},u.prototype.rotationMatrix=function(t){if(!this.valid||!t.valid)return e.create();var i=e.transpose(e.create(),this._rotation);return e.multiply(e.create(),t._rotation,i)},u.prototype.scaleFactor=function(t){return this.valid&&t.valid?Math.exp(this._scaleFactor-t._scaleFactor):1},u.prototype.translation=function(t){return this.valid&&t.valid?a.subtract(a.create(),this._translation,t._translation):a.create()},u.prototype.toString=function(){var t="Frame [ id:"+this.id+" | timestamp:"+this.timestamp+" | Hand count:("+this.hands.length+") | Pointable count:("+this.pointables.length+")";return this.gestures&&(t+=" | Gesture count:("+this.gestures.length+")"),t+=" ]"},u.prototype.dump=function(){var t="";t+="Frame Info:<br/>",t+=this.toString(),t+="<br/><br/>Hands:<br/>";for(var i=0,r=this.hands.length;i!=r;i++)t+="  "+this.hands[i].toString()+"<br/>";t+="<br/><br/>Pointables:<br/>";for(var n=0,e=this.pointables.length;n!=e;n++)t+="  "+this.pointables[n].toString()+"<br/>";if(this.gestures){t+="<br/><br/>Gestures:<br/>";for(var a=0,o=this.gestures.length;a!=o;a++)t+="  "+this.gestures[a].toString()+"<br/>"}return t+="<br/><br/>Raw JSON:<br/>",t+=JSON.stringify(this.data)},u.Invalid={valid:!1,hands:[],fingers:[],tools:[],gestures:[],pointables:[],pointable:function(){return i.Invalid},finger:function(){return i.Invalid},hand:function(){return t.Invalid},toString:function(){return"invalid frame"},dump:function(){return this.toString()},rotationAngle:function(){return 0},rotationMatrix:function(){return e.create()},rotationAxis:function(){return a.create()},scaleFactor:function(){return 1},translation:function(){return a.create()}};
},{"./hand":"N2Qt","./pointable":"GFDe","./gesture":"0zMq","gl-matrix":"oY0f","./interaction_box":"Sqgz","./finger":"9c+E","underscore":"s12q"}],"OhKw":[function(require,module,exports) {
var t=module.exports=function(t){this.pos=0,this._buf=[],this.size=t};t.prototype.get=function(t){if(null==t&&(t=0),!(t>=this.size||t>=this._buf.length))return this._buf[(this.pos-t-1)%this.size]},t.prototype.push=function(t){return this._buf[this.pos%this.size]=t,this.pos++};
},{}],"hRXA":[function(require,module,exports) {
var t=module.exports=function(t){this.steps=[],this.controller=t};t.prototype.addStep=function(t){this.steps.push(t)},t.prototype.run=function(t){for(var e=this.steps.length,r=0;r!=e&&t;r++)t=this.steps[r](t);return t},t.prototype.removeStep=function(t){var e=this.steps.indexOf(t);if(-1===e)throw"Step not found in pipeline";this.steps.splice(e,1)},t.prototype.addWrappedStep=function(t,e){var r=this.controller,o=function(o){var p,n,s;for(n=0,s=(p="frame"==t?[o]:o[t+"s"]||[]).length;n<s;n++)e.call(r,p[n]);return o};return this.addStep(o),o};
},{}],"dPDT":[function(require,module,exports) {
var e=require("./frame"),r=require("./hand"),n=require("./pointable"),t=require("./finger"),o=require("underscore"),i=require("events").EventEmitter,s=function(e){this.type=e.type,this.state=e.state};exports.chooseProtocol=function(e){var r;switch(e.version){case 1:case 2:case 3:case 4:case 5:case 6:(r=c(e)).sendBackground=function(e,n){e.send(r.encode({background:n}))},r.sendFocused=function(e,n){e.send(r.encode({focused:n}))},r.sendOptimizeHMD=function(e,n){e.send(r.encode({optimizeHMD:n}))};break;default:throw"unrecognized version"}return r};var c=exports.JSONProtocol=function(r){var n=function(r){if(r.event)return new s(r.event);n.emit("beforeFrameCreated",r);var t=new e(r);return n.emit("afterFrameCreated",t,r),t};return n.encode=function(e){return JSON.stringify(e)},n.version=r.version,n.serviceVersion=r.serviceVersion,n.versionLong="Version "+r.version,n.type="protocol",o.extend(n,i.prototype),n};
},{"./frame":"iOWN","./hand":"N2Qt","./pointable":"GFDe","./finger":"9c+E","underscore":"s12q","events":"Bmcw"}],"VUaM":[function(require,module,exports) {
var t=require("../protocol").chooseProtocol,o=require("events").EventEmitter,e=require("underscore"),s=module.exports=function(t){this.opts=e.defaults(t||{},{host:"127.0.0.1",enableGestures:!1,scheme:this.getScheme(),port:this.getPort(),background:!1,optimizeHMD:!1,requestProtocolVersion:s.defaultProtocolVersion}),this.host=this.opts.host,this.port=this.opts.port,this.scheme=this.opts.scheme,this.protocolVersionVerified=!1,this.background=null,this.optimizeHMD=null,this.on("ready",function(){this.enableGestures(this.opts.enableGestures),this.setBackground(this.opts.background),this.setOptimizeHMD(this.opts.optimizeHMD),this.opts.optimizeHMD?console.log("Optimized for head mounted display usage."):console.log("Optimized for desktop usage.")})};s.defaultProtocolVersion=6,s.prototype.getUrl=function(){return this.scheme+"//"+this.host+":"+this.port+"/v"+this.opts.requestProtocolVersion+".json"},s.prototype.getScheme=function(){return"ws:"},s.prototype.getPort=function(){return 6437},s.prototype.setBackground=function(t){this.opts.background=t,this.protocol&&this.protocol.sendBackground&&this.background!==this.opts.background&&(this.background=this.opts.background,this.protocol.sendBackground(this,this.opts.background))},s.prototype.setOptimizeHMD=function(t){this.opts.optimizeHMD=t,this.protocol&&this.protocol.sendOptimizeHMD&&this.optimizeHMD!==this.opts.optimizeHMD&&(this.optimizeHMD=this.opts.optimizeHMD,this.protocol.sendOptimizeHMD(this,this.opts.optimizeHMD))},s.prototype.handleOpen=function(){this.connected||(this.connected=!0,this.emit("connect"))},s.prototype.enableGestures=function(t){this.gesturesEnabled=!!t,this.send(this.protocol.encode({enableGestures:this.gesturesEnabled}))},s.prototype.handleClose=function(t,o){this.connected&&(this.disconnect(),1001===t&&this.opts.requestProtocolVersion>1&&(this.protocolVersionVerified?this.protocolVersionVerified=!1:this.opts.requestProtocolVersion--),this.startReconnection())},s.prototype.startReconnection=function(){var t=this;this.reconnectionTimer||(this.reconnectionTimer=setInterval(function(){t.reconnect()},500))},s.prototype.stopReconnection=function(){this.reconnectionTimer=clearInterval(this.reconnectionTimer)},s.prototype.disconnect=function(t){if(t||this.stopReconnection(),this.socket)return this.socket.close(),delete this.socket,delete this.protocol,delete this.background,delete this.optimizeHMD,delete this.focusedState,this.connected&&(this.connected=!1,this.emit("disconnect")),!0},s.prototype.reconnect=function(){this.connected?this.stopReconnection():(this.disconnect(!0),this.connect())},s.prototype.handleData=function(o){var e,s=JSON.parse(o);void 0===this.protocol?(e=this.protocol=t(s),this.protocolVersionVerified=!0,this.emit("ready")):e=this.protocol(s),this.emit(e.type,e)},s.prototype.connect=function(){if(!this.socket)return this.socket=this.setupSocket(),!0},s.prototype.send=function(t){this.socket.send(t)},s.prototype.reportFocus=function(t){this.connected&&this.focusedState!==t&&(this.focusedState=t,this.emit(this.focusedState?"focus":"blur"),this.protocol&&this.protocol.sendFocused&&this.protocol.sendFocused(this,this.focusedState))},e.extend(s.prototype,o.prototype);
},{"../protocol":"dPDT","events":"Bmcw","underscore":"s12q"}],"0kLP":[function(require,module,exports) {
var e=module.exports=require("./base"),o=require("underscore"),t=module.exports=function(o){e.call(this,o);var t=this;this.on("ready",function(){t.startFocusLoop()}),this.on("disconnect",function(){t.stopFocusLoop()})};o.extend(t.prototype,e.prototype),t.__proto__=e,t.prototype.useSecure=function(){return"https:"===location.protocol},t.prototype.getScheme=function(){return this.useSecure()?"wss:":"ws:"},t.prototype.getPort=function(){return this.useSecure()?6436:6437},t.prototype.setupSocket=function(){var e=this,o=new WebSocket(this.getUrl());return o.onopen=function(){e.handleOpen()},o.onclose=function(o){e.handleClose(o.code,o.reason)},o.onmessage=function(o){e.handleData(o.data)},o.onerror=function(o){e.useSecure()&&"wss:"===e.scheme&&(e.scheme="ws:",e.port=6437,e.disconnect(),e.connect())},o},t.prototype.startFocusLoop=function(){if(!this.focusDetectorTimer){var e=this,o=null;o=void 0!==document.hidden?"hidden":void 0!==document.mozHidden?"mozHidden":void 0!==document.msHidden?"msHidden":void 0!==document.webkitHidden?"webkitHidden":void 0,void 0===e.windowVisible&&(e.windowVisible=void 0===o||!1===document[o]);var t=window.addEventListener("focus",function(o){e.windowVisible=!0,i()}),n=window.addEventListener("blur",function(o){e.windowVisible=!1,i()});this.on("disconnect",function(){window.removeEventListener("focus",t),window.removeEventListener("blur",n)});var i=function(){var t=void 0===o||!1===document[o];e.reportFocus(t&&e.windowVisible)};i(),this.focusDetectorTimer=setInterval(i,100)}},t.prototype.stopFocusLoop=function(){this.focusDetectorTimer&&(clearTimeout(this.focusDetectorTimer),delete this.focusDetectorTimer)};
},{"./base":"VUaM","underscore":"s12q"}],"Ti/E":[function(require,module,exports) {
var global = arguments[3];
var e=arguments[3];module.exports=function(){return e.WebSocket||e.MozWebSocket};
},{}],"o5i1":[function(require,module,exports) {
var e=require("ws"),o=require("./base"),n=require("underscore"),t=module.exports=function(e){o.call(this,e);var n=this;this.on("ready",function(){n.reportFocus(!0)})};n.extend(t.prototype,o.prototype),t.__proto__=o,t.prototype.setupSocket=function(){var o=this,n=new e(this.getUrl());return n.on("open",function(){o.handleOpen()}),n.on("message",function(e){o.handleData(e)}),n.on("close",function(e,n){o.handleClose(e,n)}),n.on("error",function(){o.startReconnection()}),n};
},{"ws":"Ti/E","./base":"VUaM","underscore":"s12q"}],"w7Sm":[function(require,module,exports) {
var process = require("process");
var e=require("process"),t=require("./frame"),n=require("./hand"),i=require("./pointable"),o=require("./finger"),s=require("./circular_buffer"),r=require("./pipeline"),c=require("events").EventEmitter,a=require("./gesture").gestureListener,u=require("./dialog"),p=require("underscore"),d=module.exports=function(n){var i=void 0!==e&&e.versions&&e.versions.node,o=this;n=p.defaults(n||{},{inNode:i}),this.inNode=n.inNode,n=p.defaults(n||{},{frameEventName:this.useAnimationLoop()?"animationFrame":"deviceFrame",suppressAnimationLoop:!this.useAnimationLoop(),loopWhileDisconnected:!0,useAllPlugins:!1,checkVersion:!0}),this.animationFrameRequested=!1,this.onAnimationFrame=function(e){o.lastConnectionFrame.valid&&o.emit("animationFrame",o.lastConnectionFrame),o.emit("frameEnd",e),o.loopWhileDisconnected&&(!1!==o.connection.focusedState||o.connection.opts.background)?window.requestAnimationFrame(o.onAnimationFrame):o.animationFrameRequested=!1},this.suppressAnimationLoop=n.suppressAnimationLoop,this.loopWhileDisconnected=n.loopWhileDisconnected,this.frameEventName=n.frameEventName,this.useAllPlugins=n.useAllPlugins,this.history=new s(200),this.lastFrame=t.Invalid,this.lastValidFrame=t.Invalid,this.lastConnectionFrame=t.Invalid,this.accumulatedGestures=[],this.checkVersion=n.checkVersion,void 0===n.connectionType?this.connectionType=this.inBrowser()?require("./connection/browser"):require("./connection/node"):this.connectionType=n.connectionType,this.connection=new this.connectionType(n),this.streamingCount=0,this.devices={},this.plugins={},this._pluginPipelineSteps={},this._pluginExtendedMethods={},n.useAllPlugins&&this.useRegisteredPlugins(),this.setupFrameEvents(n),this.setupConnectionEvents(),this.startAnimationLoop()};d.prototype.gesture=function(e,t){var n=a(this,e);return void 0!==t&&n.stop(t),n},d.prototype.setBackground=function(e){return this.connection.setBackground(e),this},d.prototype.setOptimizeHMD=function(e){return this.connection.setOptimizeHMD(e),this},d.prototype.inBrowser=function(){return!this.inNode},d.prototype.useAnimationLoop=function(){return this.inBrowser()&&!this.inBackgroundPage()},d.prototype.inBackgroundPage=function(){return"undefined"!=typeof chrome&&chrome.extension&&chrome.extension.getBackgroundPage&&chrome.extension.getBackgroundPage()===window},d.prototype.connect=function(){return this.connection.connect(),this},d.prototype.streaming=function(){return this.streamingCount>0},d.prototype.connected=function(){return!!this.connection.connected},d.prototype.startAnimationLoop=function(){this.suppressAnimationLoop||this.animationFrameRequested||(this.animationFrameRequested=!0,window.requestAnimationFrame(this.onAnimationFrame))},d.prototype.disconnect=function(){return this.connection.disconnect(),this},d.prototype.frame=function(e){return this.history.get(e)||t.Invalid},d.prototype.loop=function(e){return e&&("function"==typeof e?this.on(this.frameEventName,e):this.setupFrameEvents(e)),this.connect()},d.prototype.addStep=function(e){this.pipeline||(this.pipeline=new r(this)),this.pipeline.addStep(e)},d.prototype.processFrame=function(e){e.gestures&&(this.accumulatedGestures=this.accumulatedGestures.concat(e.gestures)),this.lastConnectionFrame=e,this.startAnimationLoop(),this.emit("deviceFrame",e)},d.prototype.processFinishedFrame=function(e){if(this.lastFrame=e,e.valid&&(this.lastValidFrame=e),e.controller=this,e.historyIdx=this.history.push(e),e.gestures){e.gestures=this.accumulatedGestures,this.accumulatedGestures=[];for(var n=0;n!=e.gestures.length;n++)this.emit("gesture",e.gestures[n],e)}this.pipeline&&((e=this.pipeline.run(e))||(e=t.Invalid)),this.emit("frame",e),this.emitHandEvents(e)},d.prototype.emitHandEvents=function(e){for(var t=0;t<e.hands.length;t++)this.emit("hand",e.hands[t])},d.prototype.setupFrameEvents=function(e){e.frame&&this.on("frame",e.frame),e.hand&&this.on("hand",e.hand)},d.prototype.setupConnectionEvents=function(){var e=this;this.connection.on("frame",function(t){e.processFrame(t)}),this.on(this.frameEventName,function(t){e.processFinishedFrame(t)});var t=function(){if(e.connection.opts.requestProtocolVersion<5&&0==e.streamingCount){e.streamingCount=1;var n={attached:!0,streaming:!0,type:"unknown",id:"Lx00000000000"};e.devices[n.id]=n,e.emit("deviceAttached",n),e.emit("deviceStreaming",n),e.emit("streamingStarted",n),e.connection.removeListener("frame",t)}},n=function(){if(e.streamingCount>0){for(var t in e.devices)e.emit("deviceStopped",e.devices[t]),e.emit("deviceRemoved",e.devices[t]);for(var t in e.emit("streamingStopped",e.devices[t]),e.streamingCount=0,e.devices)delete e.devices[t]}};this.connection.on("focus",function(){e.loopWhileDisconnected&&e.startAnimationLoop(),e.emit("focus")}),this.connection.on("blur",function(){e.emit("blur")}),this.connection.on("protocol",function(t){t.on("beforeFrameCreated",function(t){e.emit("beforeFrameCreated",t)}),t.on("afterFrameCreated",function(t,n){e.emit("afterFrameCreated",t,n)}),e.emit("protocol",t)}),this.connection.on("ready",function(){e.checkVersion&&!e.inNode&&e.checkOutOfDate(),e.emit("ready")}),this.connection.on("connect",function(){e.emit("connect"),e.connection.removeListener("frame",t),e.connection.on("frame",t)}),this.connection.on("disconnect",function(){e.emit("disconnect"),n()}),this.connection.on("deviceConnect",function(i){i.state?(e.emit("deviceConnected"),e.connection.removeListener("frame",t),e.connection.on("frame",t)):(e.emit("deviceDisconnected"),n())}),this.connection.on("deviceEvent",function(t){var n=t.state,i=e.devices[n.id],o={};for(var s in n)i&&i.hasOwnProperty(s)&&i[s]==n[s]||(o[s]=!0);e.devices[n.id]=n,o.attached&&e.emit(n.attached?"deviceAttached":"deviceRemoved",n),o.streaming&&(n.streaming?(e.streamingCount++,e.emit("deviceStreaming",n),1==e.streamingCount&&e.emit("streamingStarted",n),o.attached||e.emit("deviceConnected")):o.attached&&n.attached||(e.streamingCount--,e.emit("deviceStopped",n),0==e.streamingCount&&e.emit("streamingStopped",n),e.emit("deviceDisconnected")))}),this.on("newListener",function(e,t){"deviceConnected"!=e&&"deviceDisconnected"!=e||console.warn(e+" events are depricated.  Consider using 'streamingStarted/streamingStopped' or 'deviceStreaming/deviceStopped' instead")})},d.prototype.checkOutOfDate=function(){console.assert(this.connection&&this.connection.protocol);var e=this.connection.protocol.serviceVersion,t=this.connection.protocol.version,n=this.connectionType.defaultProtocolVersion;return n>t&&(console.warn("Your Protocol Version is v"+t+", this app was designed for v"+n),u.warnOutOfDate({sV:e,pV:t}),!0)},d._pluginFactories={},d.plugin=function(e,t){return this._pluginFactories[e]&&console.warn('Plugin "'+e+'" already registered'),this._pluginFactories[e]=t},d.plugins=function(){return p.keys(this._pluginFactories)};var h=function(e,t,n){-1!=["beforeFrameCreated","afterFrameCreated"].indexOf(t)?this.on(t,n):(this.pipeline||(this.pipeline=new r(this)),this._pluginPipelineSteps[e]||(this._pluginPipelineSteps[e]=[]),this._pluginPipelineSteps[e].push(this.pipeline.addWrappedStep(t,n)))},m=function(e,s,r){var c;switch(this._pluginExtendedMethods[e]||(this._pluginExtendedMethods[e]=[]),s){case"frame":c=t;break;case"hand":c=n;break;case"pointable":c=i,p.extend(o.prototype,r),p.extend(o.Invalid,r);break;case"finger":c=o;break;default:throw e+' specifies invalid object type "'+s+'" for prototypical extension'}p.extend(c.prototype,r),p.extend(c.Invalid,r),this._pluginExtendedMethods[e].push([c,r])};d.prototype.use=function(e,t){var n,i,o,s;if(!(i="function"==typeof e?e:d._pluginFactories[e]))throw"Leap Plugin "+e+" not found.";if(t||(t={}),this.plugins[e])return p.extend(this.plugins[e],t),this;for(o in this.plugins[e]=t,s=i.call(this,t))"function"==typeof(n=s[o])?h.call(this,e,o,n):m.call(this,e,o,n);return this},d.prototype.stopUsing=function(e){var t,n=this._pluginPipelineSteps[e],i=this._pluginExtendedMethods[e],o=0;if(this.plugins[e]){if(n)for(o=0;o<n.length;o++)this.pipeline.removeStep(n[o]);if(i)for(o=0;o<i.length;o++)for(var s in t=i[o][0],i[o][1])delete t.prototype[s],delete t.Invalid[s];return delete this.plugins[e],this}},d.prototype.useRegisteredPlugins=function(){for(var e in d._pluginFactories)this.use(e)},p.extend(d.prototype,c.prototype);
},{"./frame":"iOWN","./hand":"N2Qt","./pointable":"GFDe","./finger":"9c+E","./circular_buffer":"OhKw","./pipeline":"hRXA","events":"Bmcw","./gesture":"0zMq","./dialog":"iccX","underscore":"s12q","./connection/browser":"0kLP","./connection/node":"o5i1","process":"v3go"}],"RZc+":[function(require,module,exports) {
var t=require("events").EventEmitter,e=require("underscore"),n=module.exports=function(t,e){this.start=new Vector(t),this.end=new Vector(e),this.enteredFrame=null};n.prototype.hasPointables=function(t){for(var e=0;e!=t.pointables.length;e++){var n=t.pointables[e].tipPosition;if(n.x>=this.start.x&&n.x<=this.end.x&&n.y>=this.start.y&&n.y<=this.end.y&&n.z>=this.start.z&&n.z<=this.end.z)return!0}return!1},n.prototype.listener=function(t){var e=this;return t&&t.nearThreshold&&this.setupNearRegion(t.nearThreshold),function(t){return e.updatePosition(t)}},n.prototype.clipper=function(){var t=this;return function(e){return t.updatePosition(e),t.enteredFrame?e:null}},n.prototype.setupNearRegion=function(t){var e=this.nearRegion=new n([this.start.x-t,this.start.y-t,this.start.z-t],[this.end.x+t,this.end.y+t,this.end.z+t]),r=this;e.on("enter",function(t){r.emit("near",t)}),e.on("exit",function(t){r.emit("far",t)}),r.on("exit",function(t){r.emit("near",t)})},n.prototype.updatePosition=function(t){return this.nearRegion&&this.nearRegion.updatePosition(t),this.hasPointables(t)&&null==this.enteredFrame?(this.enteredFrame=t,this.emit("enter",this.enteredFrame)):this.hasPointables(t)||null==this.enteredFrame||(this.enteredFrame=null,this.emit("exit",this.enteredFrame)),t},n.prototype.normalize=function(t){return new Vector([(t.x-this.start.x)/(this.end.x-this.start.x),(t.y-this.start.y)/(this.end.y-this.start.y),(t.z-this.start.z)/(this.end.z-this.start.z)])},n.prototype.mapToXY=function(t,e,n){var r=this.normalize(t),i=r.x,s=r.y;return i>1?i=1:i<-1&&(i=-1),s>1?s=1:s<-1&&(s=-1),[(i+1)/2*e,(1-s)/2*n,r.z]},e.extend(n.prototype,t.prototype);
},{"events":"Bmcw","underscore":"s12q"}],"LmOg":[function(require,module,exports) {
var n=module.exports=function(){return function(n){var o=n.pointables.sort(function(n,o){return n.z-o.z})[0];return o&&o.valid&&(n.cursorPosition=o.tipPosition),n}};
},{}],"EG4B":[function(require,module,exports) {
exports.UI={Region:require("./ui/region"),Cursor:require("./ui/cursor")};
},{"./ui/region":"RZc+","./ui/cursor":"LmOg"}],"/svX":[function(require,module,exports) {
module.exports={full:"0.6.4",major:0,minor:6,dot:4};
},{}],"hMEU":[function(require,module,exports) {
module.exports={Controller:require("./controller"),Frame:require("./frame"),Gesture:require("./gesture"),Hand:require("./hand"),Pointable:require("./pointable"),Finger:require("./finger"),InteractionBox:require("./interaction_box"),CircularBuffer:require("./circular_buffer"),UI:require("./ui"),JSONProtocol:require("./protocol").JSONProtocol,glMatrix:require("gl-matrix"),mat3:require("gl-matrix").mat3,vec3:require("gl-matrix").vec3,loopController:void 0,version:require("./version.js"),_:require("underscore"),EventEmitter:require("events").EventEmitter,loop:function(r,e){return r&&void 0===e&&"[object Function]"==={}.toString.call(r)&&(e=r,r={}),this.loopController?r&&this.loopController.setupFrameEvents(r):this.loopController=new this.Controller(r),this.loopController.loop(e),this.loopController},plugin:function(r,e){this.Controller.plugin(r,e)}};
},{"./controller":"w7Sm","./frame":"iOWN","./gesture":"0zMq","./hand":"N2Qt","./pointable":"GFDe","./finger":"9c+E","./interaction_box":"Sqgz","./circular_buffer":"OhKw","./ui":"EG4B","./protocol":"dPDT","gl-matrix":"oY0f","./version.js":"/svX","underscore":"s12q","events":"Bmcw"}],"V6e5":[function(require,module,exports) {
var t=require("leapjs");module.exports=function(i){var e,a,n,o,r,s;return i||(i={}),e=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],s=new THREE.Matrix4,!0===i.vr&&(this.setOptimizeHMD(!0),i.quaternion=(new THREE.Quaternion).setFromRotationMatrix((new THREE.Matrix4).set(-1,0,0,0,0,0,-1,0,0,-1,0,0,0,0,0,1)),i.scale=.001,i.position=new THREE.Vector3(0,0,-.08)),"desktop"===i.vr&&(i.scale=.001),i.getTransform=function(t){var a;return i.matrix?(a="function"==typeof i.matrix?i.matrix(t):i.matrix,window.THREE&&a instanceof THREE.Matrix4?a.elements:a):i.position||i.quaternion||i.scale?(s.set.apply(s,e),i.quaternion&&s.makeRotationFromQuaternion("function"==typeof i.quaternion?i.quaternion(t):i.quaternion),i.position&&s.setPosition("function"==typeof i.position?i.position(t):i.position),s.elements):e},i.getScale=function(t){return isNaN(i.scale)||(i.scale=new THREE.Vector3(i.scale,i.scale,i.scale)),"function"==typeof i.scale?i.scale(t):i.scale},o=function(i,e){var a,n,o,r;for(r=[],n=0,o=e.length;n<o;n++)(a=e[n])?r.push(t.vec3.transformMat4(a,a,i)):r.push(void 0);return r},n=function(t,i,e){var a,n,o;return a=i[0],n=i[1],o=i[2],t[0]=e[0]*a+e[4]*n+e[8]*o,t[1]=e[1]*a+e[5]*n+e[9]*o,t[2]=e[2]*a+e[6]*n+e[10]*o,t},a=function(t,i){var e,a,o,r;for(r=[],a=0,o=i.length;a<o;a++)(e=i[a])?r.push(n(e,e,t)):r.push(void 0);return r},r=function(i,e,n){var r,s,l,c,p,m,u,f;for(a(e,[i.direction,i.palmNormal,i.palmVelocity,i.arm.basis[0],i.arm.basis[1],i.arm.basis[2]]),l=0,p=(u=i.fingers).length;l<p;l++)r=u[l],a(e,[r.direction,r.metacarpal.basis[0],r.metacarpal.basis[1],r.metacarpal.basis[2],r.proximal.basis[0],r.proximal.basis[1],r.proximal.basis[2],r.medial.basis[0],r.medial.basis[1],r.medial.basis[2],r.distal.basis[0],r.distal.basis[1],r.distal.basis[2]]);for(t.glMatrix.mat4.scale(e,e,n),o(e,[i.palmPosition,i.stabilizedPalmPosition,i.sphereCenter,i.arm.nextJoint,i.arm.prevJoint]),c=0,m=(f=i.fingers).length;c<m;c++)r=f[c],o(e,[r.carpPosition,r.mcpPosition,r.pipPosition,r.dipPosition,r.distal.nextJoint,r.tipPosition]);return s=(n[0]+n[1]+n[2])/3,i.arm.width*=s},{frame:function(e){var a,n,o,s,l,c,p,m,u,f;if(e.valid&&!e.data.transformed){for(e.data.transformed=!0,f=[],s=0,c=(m=e.hands).length;s<c;s++){for(n=m[s],r(n,i.getTransform(n),(i.getScale(n)||new THREE.Vector3(1,1,1)).toArray()),i.effectiveParent&&r(n,i.effectiveParent.matrixWorld.elements,i.effectiveParent.scale.toArray()),o=null,l=0,p=(u=n.fingers).length;l<p;l++)a=u[l],o=t.vec3.create(),t.vec3.sub(o,a.mcpPosition,a.carpPosition),a.metacarpal.length=t.vec3.length(o),t.vec3.sub(o,a.pipPosition,a.mcpPosition),a.proximal.length=t.vec3.length(o),t.vec3.sub(o,a.dipPosition,a.pipPosition),a.medial.length=t.vec3.length(o),t.vec3.sub(o,a.tipPosition,a.dipPosition),a.distal.length=t.vec3.length(o);t.vec3.sub(o,n.arm.prevJoint,n.arm.nextJoint),f.push(n.arm.length=t.vec3.length(o))}return f}}}};
},{"leapjs":"hMEU"}],"+CLc":[function(require,module,exports) {
var e=require("leapjs"),r=require("../lib/leap.transform.js"),t=.001,n=new THREE.Vector3,o=new THREE.Quaternion;e.Controller.plugin("transform",r),module.exports=AFRAME.registerSystem("leap",{schema:{vr:{default:!0},scale:{default:t},position:{type:"vec3",default:{x:n.x,y:n.y,z:n.z}},quaternion:{type:"vec4",default:{x:o.x,y:o.y,z:o.z,w:o.w}}},init:function(){this.controller=e.loop().use("transform",this.data)},getFrame:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.controller.frame(e)}});
},{"leapjs":"hMEU","../lib/leap.transform.js":"V6e5"}],"h9F2":[function(require,module,exports) {
var e={showArm:!0,opacity:1,segments:16,boneScale:1/6,boneColor:16777215,jointScale:.2,jointColor:null},t=[6138368,10485825],s=(new THREE.Quaternion).setFromEuler(new THREE.Euler(Math.PI/2,0,0)),r=(new THREE.Quaternion).setFromEuler(new THREE.Euler(0,0,Math.PI/2)),i=0;function o(s){this.options=s=Object.assign({},e,s||{}),this.options.jointColor=this.options.jointColor||t[i%2],this.object3D=new THREE.Object3D,this.material=isNaN(s.opacity)?new THREE.MeshPhongMaterial({fog:!1}):new THREE.MeshPhongMaterial({fog:!1,transparent:!0,opacity:s.opacity}),this.createFingers(),this.createArm(),i++}o.prototype.createFingers=function(){var e,t,s,r=this.options,i=40*r.boneScale,o=40*r.jointScale;this.fingerMeshes=[];for(var n=0;n<5;n++){t=[],s=0===n?3:4;for(var h=0;h<s;h++)(e=new THREE.Mesh(new THREE.SphereGeometry(o,r.segments,r.segments),this.material.clone())).name="hand-bone-"+h,e.material.color.setHex(r.jointColor),this.object3D.add(e),t.push(e),(e=new THREE.Mesh(new THREE.CylinderGeometry(i,i,40,r.segments),this.material.clone())).name="hand-joint-"+h,e.material.color.setHex(r.boneColor),this.object3D.add(e),t.push(e);(e=new THREE.Mesh(new THREE.SphereGeometry(o,r.segments,r.segments),this.material.clone())).material.color.setHex(r.jointColor),this.object3D.add(e),t.push(e),this.fingerMeshes.push(t)}return this},o.prototype.createArm=function(){if(this.options.showArm){var e=this.options,t=40*e.boneScale,s=40*e.jointScale;this.armMesh=new THREE.Object3D,this.armBones=[],this.armSpheres=[];for(var i=0;i<=3;i++)this.armBones.push(new THREE.Mesh(new THREE.CylinderGeometry(t,t,i<2?1e3:100,e.segments),this.material.clone())),this.armBones[i].material.color.setHex(e.boneColor),this.armBones[i].castShadow=!0,this.armBones[i].name="ArmBone"+i,i>1&&this.armBones[i].quaternion.multiply(r),this.armMesh.add(this.armBones[i]);for(this.armSpheres=[],i=0;i<=3;i++)this.armSpheres.push(new THREE.Mesh(new THREE.SphereGeometry(s,e.segments,e.segments),this.material.clone())),this.armSpheres[i].material.color.setHex(e.jointColor),this.armSpheres[i].castShadow=!0,this.armSpheres[i].name="ArmSphere"+i,this.armMesh.add(this.armSpheres[i]);return this.object3D.add(this.armMesh),this}},o.prototype.traverse=function(e){for(var t,s=0;s<5;s++)for(var r=0,i=(t=this.fingerMeshes[s]).length;r<i;r++)e(t[r]);return this.armMesh&&this.armMesh.traverse(e),this},o.prototype.scaleTo=function(e){var t,s,r,i,o,n,h,a,m,p,l,f,c;for(r=e.middleFinger.proximal.length/this.fingerMeshes[2][1].geometry.parameters.height,m=f=0;f<5;m=++f)for(n=e.fingers[m],p=0;;){if(p===this.fingerMeshes[m].length-1){(l=this.fingerMeshes[m][p]).scale.set(r,r,r);break}i=n.bones[3-p/2],(l=this.fingerMeshes[m][p]).scale.set(r,r,r),p++,l=this.fingerMeshes[m][p],h=i.length/l.geometry.parameters.height,l.scale.set(r,h,r),p++}if(this.options.showArm){for(t=e.arm.length/(this.armBones[0].geometry.parameters.height+this.armBones[0].geometry.parameters.radiusTop),s=e.arm.width/(this.armBones[2].geometry.parameters.height+this.armBones[2].geometry.parameters.radiusTop),m=c=0;c<=3;m=++c)this.armBones[m].scale.set(r,m<2?t:s,r),this.armSpheres[m].scale.set(r,r,r);o=e.arm.width/2*.85,a=e.arm.length/2,this.armBones[0].position.setX(o),this.armBones[1].position.setX(-o),this.armBones[2].position.setY(a),this.armBones[3].position.setY(-a),this.armSpheres[0].position.set(-o,a,0),this.armSpheres[1].position.set(o,a,0),this.armSpheres[2].position.set(o,-a,0),this.armSpheres[3].position.set(-o,-a,0)}return this},o.prototype.formTo=function(e){var t,r,i,o,n,h;for(i=h=0;h<5;i=++h)for(r=e.fingers[i],o=0;;){if(o===this.fingerMeshes[i].length-1){(n=this.fingerMeshes[i][o]).position.fromArray(t.prevJoint);break}t=r.bones[3-o/2],(n=this.fingerMeshes[i][o]).position.fromArray(t.nextJoint),++o,(n=this.fingerMeshes[i][o]).position.fromArray(t.center()),n.setRotationFromMatrix((new THREE.Matrix4).fromArray(t.matrix())),n.quaternion.multiply(s),++o}return this.armMesh&&(this.armMesh.position.fromArray(e.arm.center()),this.armMesh.setRotationFromMatrix((new THREE.Matrix4).fromArray(e.arm.matrix())),this.armMesh.quaternion.multiply(s)),this},o.prototype.setVisibility=function(e){for(var t,s=0;s<5;s++)for(t=0;this.fingerMeshes[s][t].visible=e,++t!==this.fingerMeshes[s].length;);if(this.options.showArm)for(var r=0;r<=3;r++)this.armBones[r].visible=e,this.armSpheres[r].visible=e;return this},o.prototype.show=function(){return this.setVisibility(!0),this},o.prototype.hide=function(){return this.setVisibility(!1),this},o.prototype.getMesh=function(){return this.object3D},module.exports=o;
},{}],"D7lf":[function(require,module,exports) {
function i(i){this._index=0,this._size=i,this._array=[]}i.prototype._incr=function(){this._index=++this._index%this._size},i.prototype.array=function(){return this._array},i.prototype.push=function(i){this._array[this._index]=i,this._incr()},module.exports=i;
},{}],"sh/A":[function(require,module,exports) {
function e(e,t){this.el=e,this.handComponent=t,this.system=this.el.sceneEl.systems.leap,this.physics=this.el.sceneEl.systems.physics,this.physics.addComponent(this),this.palmBody=null,this.fingerBodies={}}e.prototype.remove=function(){for(var e in this.physics.removeComponent(this),this.fingerBodies)this.fingerBodies.hasOwnProperty(e)&&this.physics.removeBody(this.fingerBodies[e])},e.prototype.step=function(){var e,t,i=this.handComponent.getHand();if(i&&i.valid){this.syncPalmBody(i,this.palmBody||this.createPalmBody());for(var s=0;s<i.fingers.length;s++)(e=i.fingers[s]).valid&&(t=this.fingerBodies[e.type]||this.createFingerBody(e),this.syncFingerBody(e,t))}},e.prototype.createFingerBody=function(e){var t=new CANNON.Body({shape:new CANNON.Sphere(e.distal.length/2),material:this.physics.material,mass:0,fixedRotation:!0});return t.el=this.el,this.physics.addBody(t),this.fingerBodies[e.type]=t,t},e.prototype.syncFingerBody=function(){var e=new THREE.Vector3;return function(t,i){this.el.object3D.localToWorld(e.fromArray(t.distal.center())),i.position.copy(e),i.shapes[0].radius=t.distal.length/2}}(),e.prototype.createPalmBody=function(){var e=new CANNON.Body({shape:new CANNON.Sphere(.01),material:this.physics.material,mass:0});return e.el=this.el,this.physics.addBody(e),this.palmBody=e,e},e.prototype.syncPalmBody=function(){var e=new THREE.Vector3,t=new THREE.Quaternion,i=new THREE.Quaternion,s=new THREE.Euler,o=new THREE.Vector3,n=new THREE.Vector3;return function(r,a){t.setFromEuler(s.set(r.pitch(),r.yaw(),r.roll())),this.el.object3D.matrixWorld.decompose(o,i,n),a.quaternion.copy(i.multiply(t)),this.el.object3D.localToWorld(e.fromArray(r.palmPosition)),a.position.copy(e)}}(),module.exports=e;
},{}],"5gjx":[function(require,module,exports) {
var e=require("../lib/leap.hand-mesh"),t=require("circular-array"),i=require("./helpers/hand-body"),s=1,h={CLICK:"click",HANDPINCH:"handpinch",HANDGRAB:"handgrab",HANDHOLD:"handhold",RELEASE:"release",HANDOPEN:"handopen",FINGERTAP:"fingertap"},a={OPENING:"hand-opening",PINCHING:"hand-pinching",GRABBING:"hand-grabbing",HOLDING:"hand-holding",TAPPING:"finger-tapping"};function n(e){var t=0;e=e.array();for(var i=0;i<e.length;i++)t+=e[i];return t/e.length}module.exports=AFRAME.registerComponent("leap-hand",{schema:{hand:{default:"",oneOf:["left","right"],required:!0},enablePhysics:{type:"boolean",default:!1},pinchDebounce:{type:"number",default:100},pinchSensitivity:{type:"number",default:.95},grabDebounce:{type:"number",default:100},grabSensitivity:{type:"number",default:.95},openDebounce:{type:"number",default:100},openSensitivity:{type:"number",default:.95},tapDebounce:{type:"number",default:100},tapSensitivity:{type:"number",default:.1},holdSensitivity:{type:"number",default:.95},releaseSensitivity:{type:"number",default:.75},palmWearables:{type:"selectorAll",default:"null"},fingerWearables:{type:"selectorAll",default:"null"},debug:{type:"boolean",default:!1}},init:function(){this.system=this.el.sceneEl.systems.leap,this.handID=s++,this.hand=null,this.handBody=null,this.handMesh=new e,this.isVisible=!1,this.isPinching=!1,this.isGrabbing=!1,this.isHolding=!1,this.isTapping=!1;var i=Math.floor(this.data.pinchDebounce/(1e3/120)),h=Math.floor(this.data.grabDebounce/(1e3/120)),a=Math.floor(this.data.tapDebounce/(1e3/120));this.grabStrength=0,this.pinchStrength=0,this.holdStrength=0,this.tapStrength=0,this.grabStrengthBuffer=new t(h),this.pinchStrengthBuffer=new t(i),this.tapStrengthBuffer=new t(a),this.el.setObject3D("mesh",this.handMesh.getMesh()),this.el.setAttribute("visible",!1),this.palmWearables=[],this.fingerWearables=[]},update:function(){var e=this.data;e.enablePhysics&&!this.handBody?this.handBody=new i(this.el,this):!e.enablePhysics&&this.handBody&&(this.handBody.remove(),this.handBody=null);for(var t=0;t<this.palmWearables.length;t++)this.el.removeChild(this.palmWearables[t]);for(var s=0;s<this.fingerWearables.length;s++)this.el.removeChild(this.fingerWearables[s]);this.palmWearables=this.data.palmWearables;for(var h=0;h<this.palmWearables.length;h++){var a=this.palmWearables[h];a.parentNode!==this.el&&this.el.appendChild(a)}this.fingerWearables=this.data.fingerWearables;for(var n=0;n<this.fingerWearables.length;n++){var r=this.fingerWearables[n];r.parentNode!==this.el&&this.el.appendChild(r)}},remove:function(){this.handMesh&&(this.el.removeObject3D("mesh"),this.handMesh=null),this.handBody&&(this.handBody.remove(),this.handBody=null);for(var e=0;e<this.palmWearables.length;e++)this.el.removeChild(this.palmWearables[e]);for(var t=0;t<this.fingerWearables.length;t++)this.el.removeChild(this.fingerWearables[t])},tick:function(){var e=this.getHand();if(e&&e.valid){var t=this.getFinger(e,1);this.handMesh.scaleTo(e),this.handMesh.formTo(e),this.grabStrengthBuffer.push(e.grabStrength),this.pinchStrengthBuffer.push(e.pinchStrength),this.tapStrengthBuffer.push(-t.touchDistance),this.grabStrength=n(this.grabStrengthBuffer),this.pinchStrength=n(this.pinchStrengthBuffer),this.holdStrength=Math.max(this.grabStrength,this.pinchStrength),this.openStrength=1-this.holdStrength,this.tapStrength=n(this.tapStrengthBuffer);var i=this.isPinching,s=this.isGrabbing,h=this.isHolding,a=this.isOpening,r=this.isTapping,l=this.pinchStrength>(i?this.data.releaseSensitivity:this.data.pinchSensitivity),g=this.grabStrength>(s?this.data.releaseSensitivity:this.data.grabSensitivity),d=this.holdStrength>(h?this.data.releaseSensitivity:this.data.holdSensitivity),o=this.openStrength>(a?this.data.releaseSensitivity:this.data.openSensitivity),p=this.tapStrength>(r?0:this.data.tapSensitivity);d?p=!1:p&&(d=!1),l&&!i&&this.pinch(e),!l&&i&&this.release(e),g&&!s&&this.grab(e),!g&&s&&this.release(e),d&&!h&&this.hold(e),!d&&h&&this.release(e),o&&!a&&this.open(e),!o&&a&&this.release(e),p&&!r&&this.tap(e),!p&&r&&this.release(e)}else(this.isPinching||this.isGrabbing||this.isHolding)&&this.release(null);e&&!this.isVisible&&this.el.setAttribute("visible",!0),!e&&this.isVisible&&this.el.setAttribute("visible",!1),this.isVisible=!!e},getHand:function(){var e=this.data,t=this.system.getFrame();return t.hands.length?t.hands[t.hands[0].type===e.hand?0:1]:null},getFinger:function(e,t){for(var i=0;i<5;i++)if(e.fingers[i].type===t)return e.fingers[i]},pinch:function(e){var t=this.getEventDetail(e);this.el.emit(h.HANDPINCH,t);for(var i=0;i<this.palmWearables.length;i++)this.palmWearables[i].emit(h.HANDPINCH,t);this.isPinching=!0,this.el.addState(a.PINCHING)},grab:function(e){var t=this.getEventDetail(e);this.el.emit(h.HANDGRAB,t);for(var i=0;i<this.palmWearables.length;i++)this.palmWearables[i].emit(h.HANDGRAB,t);this.isGrabbing=!0,this.el.addState(a.GRABBING)},open:function(e){var t=this.getEventDetail(e);this.el.emit(h.HANDOPEN,t);for(var i=0;i<this.palmWearables.length;i++)this.palmWearables[i].emit(h.HANDOPEN,t);this.isOpening=!0,this.el.addState(a.OPENING)},hold:function(e){var t=this.getEventDetail(e);this.el.emit(h.HANDHOLD,t);for(var i=0;i<this.palmWearables.length;i++)this.palmWearables[i].emit(h.HANDHOLD,t);this.isHolding=!0,this.el.addState(a.HOLDING)},tap:function(e){var t=this.getEventDetail(e);this.el.emit(h.FINGERTAP,t);for(var i=0;i<this.palmWearables.length;i++)this.palmWearables[i].emit(h.FINGERTAP,t);for(var s=0;s<this.fingerWearables.length;s++)this.fingerWearables[s].emit(h.FINGERTAP,t);this.isTapping=!0,this.el.addState(a.TAPPING)},release:function(e){var t=this.getEventDetail(e);this.el.emit(h.RELEASE,t),this.el.emit(h.CLICK,t);for(var i=0;i<this.palmWearables.length;i++)this.palmWearables[i].emit(h.RELEASE,t);for(var s=0;s<this.fingerWearables.length;s++)this.fingerWearables[s].emit(h.RELEASE,t);this.isPinching&&(this.el.removeState(a.PINCHING),this.isPinching=!1),this.isGrabbing&&(this.el.removeState(a.GRABBING),this.isGrabbing=!1),this.isHolding&&(this.el.removeState(a.HOLDING),this.isHolding=!1),this.isOpening&&(this.el.removeState(a.OPENING),this.isOpening=!1),this.isTapping&&(this.el.removeState(a.TAPPING),this.isTapping=!1)},getEventDetail:function(e){return{hand:e,handID:this.handID,body:this.handBody?this.handBody.palmBody:null}}});
},{"../lib/leap.hand-mesh":"h9F2","circular-array":"D7lf","./helpers/hand-body":"sh/A"}],"Xgk3":[function(require,module,exports) {
module.exports=AFRAME.registerComponent("leap-wearable",{schema:{hand:{type:"selector"},finger:{type:"boolean",default:!1},fingerId:{type:"number",default:1,oneOf:[0,1,2,3,4]},holdDistance:{type:"number",default:0},lookAtOrigin:{type:"boolean",default:!0},raycaster:{type:"selector"},crawling:{type:"boolean",default:!1},crawlingDistance:{type:"number",default:.05}},init:function(){this.intersection=null,this.handEl=null,this.raycasterEl=null,this.addEventListeners=this.addEventListeners.bind(this),this.removeEventListeners=this.removeEventListeners.bind(this),this.onIntersection=this.onIntersection.bind(this),this.onIntersectionCleared=this.onIntersectionCleared.bind(this)},update:function(){this.data.hand?this.handEl=this.data.hand:this.handEl=this.el.parentNode,this.data.raycaster?this.raycasterEl=this.data.raycaster:void 0!==this.el.components.raycaster?this.raycasterEl=null:this.raycasterEl=this.el.parentNode.querySelector(["raycaster"]),this.addEventListeners()},addEventListeners:function(){var e=this,t=this.raycasterEl;t&&(t.addEventListener("raycaster-intersection",function(t){e.onIntersection(t)}),t.addEventListener("raycaster-intersection-cleared",function(t){e.onIntersectionCleared(t)}))},removeEventListeners:function(){var e=this,t=this.raycasterEl;t&&(t.removeEventListener("raycaster-intersection",function(t){e.onIntersection(t)}),t.removeEventListener("raycaster-intersection-cleared",function(t){e.onIntersectionCleared(t)}))},onIntersection:function(e){this.intersection=this.getNearestIntersection(e.detail.intersections)},onIntersectionCleared:function(e){this.intersection=null},getNearestIntersection:function(e){for(var t=0,n=e.length;t<n;t++)if(this.el!==e[t].object.el&&!e[t].object.el.classList.contains("ignore-ray"))return e[t];return null},remove:function(){this.handEl=null,this.raycasterEl=null,this.intersection=null,this.removeEventListeners()},crawl:function(){var e=this.intersection,t=(new THREE.Matrix4).getInverse(this.handEl.object3D.matrixWorld),n=e.point.clone(),i=e.face.normal.clone().normalize(),r=(new THREE.Vector3).addVectors(n,i).applyMatrix4(t);this.el.object3D.lookAt(r);var s=(new THREE.Vector3).addVectors(n,i.multiplyScalar(this.data.crawlingDistance)).applyMatrix4(t);this.el.object3D.position.set(s.x,s.y,s.z)},tick:function(){var e=this.handEl.components["leap-hand"],t=e.getHand();if(t&&t.valid)if(this.data.finger){var n=e.getFinger(t,this.data.fingerId),i=new THREE.Vector3,r=new THREE.Vector3;i.fromArray(n.tipPosition),r.copy(i),this.el.object3D.position.set(r.x,r.y,r.z)}else{var s=(new THREE.Vector3).fromArray(t.palmPosition),a=(new THREE.Vector3).fromArray(t.palmNormal),o=(new THREE.Vector3).fromArray(t.direction).divideScalar(2).add(a).normalize(),c=(new THREE.Vector3).copy(o).multiplyScalar(this.data.holdDistance),l=(new THREE.Vector3).copy(s).add(c);this.el.object3D.position.set(l.x,l.y,l.z),this.data.lookAtOrigin&&this.el.object3D.lookAt(s),void 0!==this.el.components.raycaster&&this.el.setAttribute("raycaster",{origin:s,direction:o})}}});
},{}],"Focm":[function(require,module,exports) {
require("./src/leap-system"),require("./src/leap-hand"),require("./src/leap-wearable");
},{"./src/leap-system":"+CLc","./src/leap-hand":"5gjx","./src/leap-wearable":"Xgk3"}],"3hpa":[function(require,module,exports) {
require("./index");
},{"./index":"Focm"}]},{},["3hpa"], null)
//# sourceMappingURL=/aframe-leap-hands.min.map