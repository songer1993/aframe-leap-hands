<html>

<head>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no,user-scalable=no,maximum-scale=1">
	<title>Examples â€¢ Grabbing</title>
	<script src="./dist/aframe-leap-hands.js"></script>
	<script src="./playground.js"></script>
</head>

<body>
	<a-scene physics="gravity: 0">
		<a-assets>
			<!-- hand cursor ring -->
			<a-mixin id="hand-cursor-ring" position="0 0 0" scale="1 1 1" geometry="primitive: ring;radiusOuter: 0.008; radiusInner: 0.005; segmentsTheta: 32"
			  material="color: black; shader: flat; opacity: 0.75" animation="startEvents: click; easing: easeInQuad; property: scale; dir: alternate; from: 1 1 1; to: 5 5 5; dur: 500; loop: 2"></a-mixin>
			<!-- hand cursor -->
			<a-mixin id="hand-cursor" raycaster="showLine: true; objects: [mixin=cube]" super-hands="colliderEvent:raycaster-intersection; colliderEventProperty:els; colliderEndEvent:raycaster-intersection-cleared; colliderEndEventProperty:clearedEls; grabStartButtons: handhold; grabEndButtons: release; stretchStartButtons: handhold; stretchEndButtons: release; dragDropStartButtons: handhold; dragDropEndButtons: release"
			  static-body="shape: sphere; sphereRadius: 0.02"></a-mixin>
			<!-- finger clicker -->
			<a-mixin id="finger-clicker" raycaster="showLine: false; objects: [mixin=cube]" super-hands="colliderEvent:raycaster-intersection; colliderEventProperty:els; colliderEndEvent:raycaster-intersection-cleared; colliderEndEventProperty:clearedEls; grabStartButtons: fingertap; grabEndButtons: fingertap;"
			  static-body="shape: sphere; sphereRadius: 0.02"></a-mixin>
			<!-- hand finger -->
			<a-mixin id="finger-tip" geometry="primitive: sphere; radius: 0.02" material="color: blue; opacity: 0.75" physics-collider
			  static-body="shape: sphere; sphereRadius: 0.02" super-hands="colliderEvent: collisions; colliderEventProperty: els; colliderEndEvent: collisions; colliderEndEventProperty: clearedEls; grabStartButtons: collisions; grabEndButtons: collisions"
			  collision-filter="group: hands; collidesWith: cube; collisionForces: false"></a-mixin>
			<!-- cube -->
			<a-mixin id="cube" geometry="primitive: box; width: 0.25; height: 0.25; depth: 0.25" material="opacity: 0.75" dynamic-body
			  grabbable sleepy collision-filter="group: cube; collidesWith: default, hands"></a-mixin>

			<a-mixin id="interactable" hoverable grabbable stretchable draggable dropppable></a-mixin>
		</a-assets>

		<!-- camera rig -->
		<a-entity id="#cameraRig" position="0 0.3 0">
			<!-- camera setting -->
			<a-camera near=0.01 fov=110 position="0 0 0">
				<!-- leap hands -->
				<a-entity id="left-hand" leap-hand="hand: left; enablePhysics: false; palmWearables: #palm-box; fingerWearables: null;">
					<a-entity id="palm-box" geometry="primitive: box; width: 0.05; height: 0.05; depth: 0.05" material="opacity: 0.75; color: red"
					  static-body grabbable sleepy collision-filter="group: cube; collidesWith: default, hands" leap-wearable="distance:0.05"></a-entity>
				</a-entity>
				<a-entity id="right-hand" leap-hand="hand: right; enablePhysics: false; palmWearables: #palm-raycaster, #palm-ring, #index-finger-clicker; fingerWearables: #index-finger-tip">
					<a-entity id="index-finger-clicker" mixin="finger-clicker" leap-wearable=""></a-entity>
					<a-entity id="palm-raycaster" mixin="hand-cursor" leap-wearable=""></a-entity>
					<a-entity id="palm-ring" mixin="hand-cursor-ring" leap-wearable="distance: 0.15"></a-entity>
					<a-entity id="index-finger-tip" mixin="finger-tip" leap-wearable="finger: true; fingerId: 1"></a-entity>
				</a-entity>
			</a-camera>
		</a-entity>


		<a-entity id="box1" mixin="cube" position="-0.125 0.1 -1" material="color: red"></a-entity>
		<a-entity id="box2" mixin="cube" position="0.00 0.4 -1" material="color: green"></a-entity>
		<a-entity id="box3" mixin="cube" position="0.125 0.1 -1" material="color: blue"></a-entity>

		<!-- Terrain -->
		<a-grid static-body></a-grid>

		<!-- Lighting -->
		<a-light type="ambient" color="#ccc"></a-light>
		<a-light color="#ddf" distance="100" intensity="0.4" type="point"></a-light>
		<a-light color="#ddf" position="3 10 -10" distance="50" intensity="0.4" type="point"></a-light>
	</a-scene>
	<script>
		var box1 = document.querySelector('#box1');
		var box2 = document.querySelector('#box2');
		var box3 = document.querySelector('#box3');
		var rightHand = document.querySelector("#right-hand");
		var leftHand = document.querySelector("#left-hand");
		var palmBox = document.querySelector('#palm-box');

		function checkClickEvent(e) {
			if (e instanceof MouseEvent) {
				const data = e.fromElement.components['super-hands'].data;
				if (data.grabStartButtons[0] == data.grabEndButtons[0]) {
					return true;
				} else {
					return false;
				}
			} else {
				return false;
			}
		}

		palmBox.addEventListener('click', (e) => {
			if (checkClickEvent(e)) {
				palmBox.setAttribute('material', 'color', getRandomColor());
			}
		});


		box1.addEventListener('click', (e) => {
			if (checkClickEvent(e)) {
				box1.setAttribute('material', 'color', getRandomColor());
			}
		});

		box2.addEventListener('click', () => {
			box2.setAttribute('material', 'color', getRandomColor());
		});

		box3.addEventListener('click', () => {
			box3.setAttribute('material', 'color', getRandomColor());
		});

		rightHand.addEventListener('grab-start', (e) => {
			console.log(e);
		});
	</script>
</body>

</html>